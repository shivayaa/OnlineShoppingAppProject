(function(q){var h=window.AmazonUIPageJS||window.P,n=h._namespace||h.attributeErrors,t=n?n("VSEComponentAssets",""):h;t.guardFatal?t.guardFatal(q)(t,window):t.execute(function(){q(t,window)})})(function(q,h,n){(function(){function t(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var b=16*Math.random()|0;return("x"==c?b:b&3|8).toString(16)})}function V(c,b){b={contentId:""+c.initialVideo.contentId,customerId:c.customerId,isForesterTrackingDisabled:c.sushiMetricsConfig.isRobot,
foresterMetadataParams:{client:c.requestMetadata.clientId,marketplaceId:c.requestMetadata.marketplaceId,method:c.requestMetadata.method,requestId:c.requestMetadata.requestId,session:c.requestMetadata.sessionId},mediaSourceInfo:[""+c.initialVideo.videoUrl],posterSource:c.initialVideo.imageUrl,pageAsin:c.requestMetadata.pageAsin,parentId:b,vendorCode:c.initialVideo.vendorCode,shouldStartMuted:c.shouldStartMuted,shouldAutoplay:c.shouldAutoplay,shouldDisableControls:c.shouldDisableControls,useCarousel:c.useCarousel,
useBuyBox:c.useBuyBox,languagePreferenceStrings:c.languagePreferenceStrings,sushiMetricsConfig:{eventSource:c.sushiMetricsConfig.eventSource,endpoint:c.sushiMetricsConfig.endpoint,requestId:c.sushiMetricsConfig.requestId,sessionId:c.sushiMetricsConfig.sessionId,customerId:c.sushiMetricsConfig.customerId,refMarkers:c.sushiMetricsConfig.refMarkers,sessionType:c.sushiMetricsConfig.sessionType,placementContext:c.sushiMetricsConfig.placementContext,marketplaceId:c.sushiMetricsConfig.marketplaceId,weblabIds:c.sushiMetricsConfig.weblabIds,
pageAsin:c.sushiMetricsConfig.pageAsin,isInternal:c.sushiMetricsConfig.isInternal,isRobot:c.sushiMetricsConfig.isRobot,clientId:c.sushiMetricsConfig.clientId},refTag:c.refTag,ospData:{vendorTrackingId:c.initialVideo.vendorTrackingId,videoReferenceId:c.initialVideo.videoReferenceId,productAsin:c.initialVideo.productAsin},useUpNextComponent:c.useUpNextComponent,isVideoImmersivePlayer:c.isVideoImmersivePlayer,ospLinkCode:c.ospLinkCode,showClosedCaptions:c.showClosedCaptions};c.eventTimestamp&&(b.eventTimestamp=
c.eventTimestamp);return b}h.vseFeatures=h.vseFeatures||{};var z=h.gatedP||{register:function(c,b,a,f,m){void 0===m&&(m=h.vseFeatures);q.now(c).execute(c+"-prereg",function(e){e||m[b]||(m[b]=!0,f.resolve(a(f)).then(function(){q.now(c).execute(c+"-reg",function(a){a||(q.log("Gated registration failed to register module!","ERROR",c),m[b]=!1)})}))})},declare:function(c,b,a,f){void 0===f&&(f=h.vseFeatures);q.now(c).execute(c+"-prereg",function(m){m||f[b]||(f[b]=!0,q.declare(c,a))})}},l={count:function(c,
b){var a=h.ue;a&&a.count("vse:csm:"+c,b)},emitSushiMetric:function(c,b,a){var f=this;b=b||"https://unagi-na.amazon.com/1/events/com.amazon.eel.vse.metricstest.nexus";a=a||0;if(!(3<=a)){var m=JSON.stringify(c).replace(/\\\\/g,""),e={params:m,paramsFormat:"json",contentType:"application/json; charset\x3dutf-8",error:function(){f.emitSushiMetric(c,b,++a)}},g=navigator.userAgent.match(/iPhone/i),C=!1;q.now("mash").execute("vse-detect-mshop",function(){C=!0});var u=null!==g&&C;q.when("A").execute("Emit-VSE-Metrics",
function(a){navigator&&navigator.sendBeacon&&!u?navigator.sendBeacon(b,m):a.post(b,e)})}},logFatal:function(c,b,a){h.ueLogError&&h.ueLogError(a,{logLevel:"FATAL",attribution:c,message:b})},logError:function(c,b,a){h.ueLogError&&h.ueLogError(a,{logLevel:"ERROR",attribution:c,message:b})}},I={makeApplicationSushiPayloadBuilder:function(c,b){return function(a){var f={eventSource:b.eventSource,requestId:b.requestId,sessionId:b.sessionId,placementContext:b.placementContext,marketplaceId:b.marketplaceId,
weblabIds:b.weblabIds,clientId:b.clientId,isInternal:b.isInternal.toString(),isRobot:b.isRobot.toString(),pageAsin:b.pageAsin,customerId:b.customerId,sessionType:b.sessionType||1,refMarkers:b.refMarkers,eventId:t(),timestamp:new Date,userAgentData:navigator.userAgent,titleSessionId:0,videoAsin:0,pageUrl:null!==h.location.href?h.location.href.substring(0,500):"",videoAsinList:b.videoAsinList||""};return{events:[{data:c.$.extend(f,a)}]}}}},v={fetchLatestPageState:function(c,b){c.state.replace(b,JSON.parse(c.$("script[type\x3d'a-state'][data-a-state*\x3d"+
b+"]").html()));return c.state(b)},isDefined:function(c){return"undefined"!==typeof c&&null!==c}},p={updateReftagParam:function(c,b){return p.updateQueryStringParameter(c,"ref_?","ref",b)},updateQueryStringParameter:function(c,b,a,f){b=new RegExp("([?\x26/])"+b+"\x3d.*?(\x26|$)","i");var m=-1!==c.indexOf("?")?"\x26":"?";return c.match(b)?c.replace(b,"$1"+a+"\x3d"+f+"$2"):c+m+a+"\x3d"+f},generateUUID:function(){for(var c="",b=0;13>b;b++)c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*
Math.random()));return c},decodeEntities:function(c){var b=document.createElement("textarea");b.innerHTML=c;return b.value},triggerShare:function(c,b,a,f){if(b){b=screen.width;var m=screen.height;a=a?a:.7*b;f=f?f:.7*m;h.open(c,"_blank","toolbar\x3d0,status\x3d0,width\x3d"+a+",height\x3d"+f+",top\x3d"+(m/2-f/2)+",left\x3d"+(b/2-a/2))}else h.open(c,"_self")},getPageData:function(c){return"undefined"!==typeof c.pageLevelStateKey?A.state(c.pageLevelStateKey):c.pageLevelData},buildUrl:function(c,b){b=
b||{};for(var a=h.navigator&&h.navigator.userAgent&&h.navigator.userAgent.match(/iPhone/i),f=Object.keys(b),m=0<f.length&&("sms:"!==c||!a)?"?":"",a=0;a<f.length;a++)"?"!==m&&(m+="\x26"),b[f[a]]&&(m+=f[a]+"\x3d"+encodeURIComponent(b[f[a]]));return c+m},generateReftags:function(c,b){var a,f;c=p.getPageData(c);"undefined"!==typeof c&&(a=c.clientRef,f=c.deviceTypeRef);a=a?a:"un";f=f?f:"un";c=b?b:"un";b=p.generateUUID();c="cm_sw_"+c;a=a+"_"+f+"_"+b;return{returnReftag:c+"_r_"+a,clickReftag:c+"_c_"+a}}},
W={share:function(c,b){b={facebook:{shareEndpoint:"https://www.facebook.com/dialog/share",params:function(a){return{href:p.decodeEntities(a.url),display:"popup",quote:a.quote?p.decodeEntities(a.quote):"",app_id:"465632727431967"}},ref:"fb",height:450,width:700,isWebShare:!0},pinterest:{shareEndpoint:"https://www.pinterest.com/pin/create/button",params:function(a){return{url:p.decodeEntities(a.url),media:p.decodeEntities(a.image),description:p.decodeEntities(a.description)}},ref:"pi",height:620,width:700,
isWebShare:!0},twitter:{shareEndpoint:"https://twitter.com/intent/tweet",params:function(a){var b=p.decodeEntities(a.title);a=p.decodeEntities(a.url);if(b){var c=a?Math.min(a.length,20):-1;200<b.length+c+1&&(b=b.substring(0,200-(c+1+3))+"...")}return{text:b,url:a}},ref:"tw",height:470,width:670,isWebShare:!0},email:{shareEndpoint:"mailto:",params:function(a){return{subject:p.decodeEntities(a.title),body:p.decodeEntities(a.description)+"\n"+p.decodeEntities(a.url)}},ref:"em",height:470,width:670,isWebShare:!1},
sms:{shareEndpoint:"sms:",params:function(a){return{body:p.decodeEntities(a.title)+" "+p.decodeEntities(a.url)}},ref:"sm",height:470,width:670,isWebShare:!1},whatsapp:{shareEndpoint:"https://api.whatsapp.com/send",params:function(a){return{text:p.decodeEntities(a.description)+"\n"+p.decodeEntities(a.url)}},ref:"wa",height:470,width:670,isWebShare:!1}}[b];var a=p.generateReftags(c,b.ref);c.url=p.updateReftagParam(c.url,a.returnReftag);c=p.buildUrl(b.shareEndpoint,b.params(c));p.triggerShare(c,b.isWebShare,
b.width,b.height)}},y={sendRequest:function(c,b,a,f,m){c.ajax(b,{params:a,paramsFormat:"json",crossDomain:!0,method:"POST",withCredentials:!0,contentType:"application/json",success:f,error:m})}},D=function(){return function(c){this.message=c}}(),J=function(){function c(b,a){void 0===a&&(a={refTagRecorderEndPoint:"/gp/mobile/tag/",retryLimit:3});this.A=b;this.config=a}c.prototype.emitRefTag=function(b,a){void 0===a&&(a=0);if(!(a>=this.config.retryLimit)){var f=this;this.A.post(this.config.refTagRecorderEndPoint+
"ref\x3d"+b,{error:function(){f.emitRefTag(b,++a)}})}};return c}(),K={queueComplete:!0},L=function(){function c(b,a,f){var c=this;this.player=b;this.frame=a;this.assets=[];this.currentIndex=0;this.eventEmitter=new f.EventEmitter;this.player.on("playbackComplete",function(){c.currentIndex++;c.doPlay()})}c.prototype.play=function(b){b?this.player.play(b):this.player.play();return this};c.prototype.getCurrentTime=function(){return this.player.getCurrentTime()};c.prototype.setCurrentTime=function(b){this.player.setCurrentTime(b);
return this};c.prototype.getMediaDuration=function(){return this.player.getMediaDuration()};c.prototype.mute=function(){this.player.mute();return this};c.prototype.unmute=function(){this.player.unmute();return this};c.prototype.isMuted=function(){return this.player.isMuted()};c.prototype.resume=function(b){this.player.resume(b);return this};c.prototype.pause=function(){this.player.pause();return this};c.prototype.next=function(){this.player.stop();this.currentIndex++;this.doPlay();return this};c.prototype.previous=
function(){this.player.stop();this.currentIndex--;this.doPlay();return this};c.prototype.seek=function(b){this.player.seek(b);return this};c.prototype.enqueue=function(b,a){void 0===a&&(a=this.assets.length);b instanceof Array?(b=b.slice(),b.splice(0,0,this.assets),Array.prototype.splice.apply(this.assets,b)):this.assets.splice(a,0,b);return this};c.prototype.dequeue=function(b){var a=this,f;if("number"===typeof b)f=[b];else if(b instanceof Array){var c=b.map(function(a){return a.contentId});f=this.assets.map(function(a){return c.indexOf(a.contentId)}).filter(function(a){-1!=
a})}else f=[this.assets.map(function(a,b){return b}).filter(function(f){a.assets[f].contentId==b.contentId})[0]];for(var e=0,g=f.length;e<g;e++)this.assets.splice(f[e],1);return this};c.prototype.on=function(b,a){if(K.hasOwnProperty(b))this.eventEmitter.on(b,a);else this.player.on(b,a);return this};c.prototype.off=function(b,a){K.hasOwnProperty(b)?this.eventEmitter.off(b,a):this.player.off(b,a);return this};c.prototype.getAssets=function(){return this.assets};c.prototype.getCurrentAssetIndex=function(){return this.currentIndex-
1};c.prototype.getPosition=function(){return this.player.getPosition()};c.prototype.isPlaying=function(){return this.player.isPlaying()};c.prototype.isPaused=function(){return this.player.isPaused()};c.prototype.getVersion=function(){return this.player.getVersion()};c.prototype.destroy=function(){this.player.destroy()};c.prototype.addChild=function(b,a){this.player.addChild(b,a);return this};c.prototype.removeChild=function(b){this.player.removeChild(b);return this};c.prototype.loadNextVideoPoster=
function(b){this.player.loadNextVideoPoster(b);return this};c.prototype.blur=function(){this.player.blur();return this};c.prototype.requestFullscreen=function(){this.player.requestFullscreen();return this};c.prototype.exitFullscreen=function(){this.player.exitFullscreen();return this};c.prototype.isFullscreen=function(){return this.player.isFullscreen()};c.prototype.fluid=function(b){this.player.fluid(b);return this};c.prototype.aspectRatio=function(b){this.player.aspectRatio(b);return this};c.prototype.enableCurrentTextTrack=
function(b){void 0===b&&(b="en");this.player.enableCurrentTextTrack(b);return this};c.prototype.disableCurrentTextTrack=function(b){void 0===b&&(b="en");this.player.disableCurrentTextTrack(b);return this};c.prototype.updateTextTrack=function(b){this.player.updateTextTrack(b);return this};c.prototype.doPlay=function(){var b=this.player.getCurrent();b?this.assets[this.currentIndex].contentId==b.contentId?this.player.play():this.player.play(this.assets[this.currentIndex]):this.assets[this.currentIndex]&&
this.player.play(this.assets[this.currentIndex])};return c}(),M=function(){function c(b,a,f,c){var e=this;this.config=a;this.libs=c;this.eventEmitter=new c.EventEmitter;this.currentAsset=f;this.initHandlers();c=document.getElementById(a.parentId);var g=document.createElement("video");f=a.parentId+"-element";g.id=f;g.className=a.isVideoImmersivePlayer?"video-js brila-vip-vjs":"video-js brila-video-js";g.setAttribute("playsinline","true");a.shouldDisableControls||g.setAttribute("controls","true");a.shouldAutoplay&&
g.setAttribute("autoplay","true");a.shouldStartMuted&&g.setAttribute("muted","true");c.appendChild(g);c={player:{techOrder:["html5"],textTrackSettings:!1,html5:{nativeTextTracks:!1}}};a.isVideoImmersivePlayer&&(c.player.bigPlayButton=!1,c.player.posterImage=a.posterSource,c.player.controlBar={playToggle:!1,volumePanel:!1,currentTimeDisplay:!0,remainingTimeDisplay:!0,fullscreenToggle:!1});this.videoJS=c=b.embed(f,a,c);document.getElementById(f).setAttribute("style","width:100%; height:100%;");this.videoJS.poster(a.posterSource);
this.videoJS.src(a.mediaSourceInfo[0]);this.vseMetrics=b.metrics(this.videoJS);a.isVideoImmersivePlayer?(this.videoJS.on("click",function(){e.eventEmitter.emit("playerClick")}),this.videoJS.on("touchstart",function(){e.eventEmitter.emit("playerClick")})):this.videoJS.aspectRatio("16:9");this.videoJS.on("ended",function(){e.eventHandlers.onPlaybackComplete()});this.videoJS.on("playing",function(){e.eventHandlers.onPlaybackStart()});this.videoJS.on("cancelContinuousPlay",function(){e.eventHandlers.onCancelContinuousPlay()});
this.videoJS.on("playUpNext",function(){e.eventHandlers.onPlayUpNext()});var C=this;c.ready(function(){C.eventEmitter.emit("playerLoaded")})}c.prototype.play=function(b){if(this.isDPXDesktopFullScreenRequest(b))this.vseMetrics.setPageLoadStartTimestamp(Date.now()),this.videoJS.play();else{var a=this.getTextTrackMode("en");!b||this.currentAsset&&b.contentId==this.currentAsset.contentId||(this.videoJS.poster(b.imageUrl),this.videoJS.posterImage.show(),this.vseMetrics.setContentId&&this.vseMetrics.setContentId(b.contentId),
this.vseMetrics.setRefTag&&this.vseMetrics.setRefTag(b.refTag?b.refTag:""),this.vseMetrics.setOspAttribution&&this.vseMetrics.setOspAttribution({vendorTrackingId:b.vendorTrackingId?b.vendorTrackingId:"",videoReferenceId:b.videoReferenceId?b.videoReferenceId:"",productAsin:b.productAsin?b.productAsin:""}),this.videoJS.src(b.videoUrl),this.currentAsset=b);if(this.config.showClosedCaptions){this.removeCurrentTextTracks();var f=[];this.currentAsset&&this.currentAsset.closedCaptions&&(f=this.currentAsset.closedCaptions);
b&&b.closedCaptions&&(f=b.closedCaptions);this.updateTextTrack(f);"showing"===a&&this.enableCurrentTextTrack()}b=b&&b.eventTimestamp?b.eventTimestamp:Date.now();this.vseMetrics.setPageLoadStartTimestamp(b);return this.videoJS.play()}};c.prototype.updateTextTrack=function(b){var a=this;b.forEach(function(b){a.videoJS.addRemoteTextTrack({src:b.url,kind:"subtitles",srclang:b.locale,label:"English","default":!1},!1)})};c.prototype.enableCurrentTextTrack=function(b){void 0===b&&(b="en");this.changeTextTrackMode(b,
"showing")};c.prototype.disableCurrentTextTrack=function(b){void 0===b&&(b="en");this.changeTextTrackMode(b,"disabled")};c.prototype.muted=function(b){return this.videoJS.muted(b)};c.prototype.mute=function(){this.videoJS.muted(!0);return this};c.prototype.unmute=function(){this.videoJS.muted(!1);return this};c.prototype.isMuted=function(){return this.videoJS.muted()};c.prototype.getCurrentTime=function(){return this.videoJS.currentTime()};c.prototype.setCurrentTime=function(b){this.videoJS.currentTime(b);
return this};c.prototype.getMediaDuration=function(){return isNaN(this.videoJS.duration())?0:this.videoJS.duration()};c.prototype.pause=function(){this.videoJS.pause();return this};c.prototype.resume=function(b){this.videoJS.play();return this};c.prototype.seek=function(b){this.videoJS.currentTime(b);return this};c.prototype.stop=function(){this.videoJS.pause();this.currentAsset=n;return this};c.prototype.on=function(b,a){this.eventEmitter.on(b,a);this.videoJS.on(b,a);return this};c.prototype.off=
function(b,a){return this};c.prototype.getCurrent=function(){return this.currentAsset};c.prototype.getPosition=function(){return this.videoJS.currentTime()};c.prototype.isPlaying=function(){return!this.videoJS.paused()};c.prototype.isPaused=function(){return this.videoJS.paused()};c.prototype.getVersion=function(){return"VJS"};c.prototype.destroy=function(){this.vseMetrics.publishBeforeDispose();this.videoJS.off("ended",this.eventHandlers.onPlaybackComplete);this.videoJS.dispose();this.videoJS=null};
c.prototype.addChild=function(b,a){this.videoJS.addChild(b,a);return this};c.prototype.removeChild=function(b){this.videoJS.removeChild(b);return this};c.prototype.loadNextVideoPoster=function(b){this.videoJS.poster(b);this.videoJS.posterImage.show();return this};c.prototype.aspectRatio=function(b){this.videoJS.aspectRatio(b);return this};c.prototype.requestFullscreen=function(){this.videoJS.requestFullscreen();return this};c.prototype.exitFullscreen=function(){this.videoJS.exitFullscreen();return this};
c.prototype.isFullscreen=function(){return this.videoJS.isFullscreen()};c.prototype.fluid=function(b){this.videoJS.fluid(b);return this};c.prototype.blur=function(){this.videoJS.blur();return this};c.prototype.initHandlers=function(){var b=this;this.eventHandlers={onPlaybackComplete:function(){return b.player_onPlaybackComplete()},onPlaybackStart:function(){return b.player_onPlaybackStart()},onCancelContinuousPlay:function(){return b.player_onCancelContinuousPlay()},onPlayUpNext:function(){return b.player_onPlayUpNext()}}};
c.prototype.player_onPlaybackComplete=function(){var b=this.currentAsset;this.previousAsset=this.currentAsset;this.currentAsset=n;this.previousAsset&&(this.previousAsset.eventTimestamp=Date.now());this.eventEmitter.emit("playbackComplete",b)};c.prototype.player_onCancelContinuousPlay=function(){this.currentAsset=this.previousAsset;this.eventEmitter.emit("cancelContinuousPlay",this.previousAsset)};c.prototype.player_onPlayUpNext=function(){this.eventEmitter.emit("playUpNext",this.previousAsset)};c.prototype.player_onPlaybackStart=
function(){this.currentAsset&&(this.currentAsset.eventTimestamp=Date.now());this.eventEmitter.emit("playbackStart",this.currentAsset)};c.prototype.isDPXDesktopFullScreenRequest=function(b){return this.config.sushiMetricsConfig&&this.config.sushiMetricsConfig.placementContext&&-1!==this.config.sushiMetricsConfig.placementContext.indexOf("desktop_web.ImageBlock")&&b&&!b.hasOwnProperty("refTag")&&b.contentId!==this.currentAsset.contentId};c.prototype.changeTextTrackMode=function(b,a){var f=this.videoJS.remoteTextTracks();
if(f)for(var c=0;c<f.length;c++){var e=f[c];"subtitles"===e.kind&&e.language===b&&(e.mode=a)}};c.prototype.getTextTrackMode=function(b){var a=this.videoJS.remoteTextTracks();if(a)for(var f=0;f<a.length;f++){var c=a[f];if("subtitles"===c.kind&&c.language===b)return c.mode}return"disabled"};c.prototype.removeCurrentTextTracks=function(){var b=this.videoJS.remoteTextTracks();if(b)for(var a=0;a<b.length;a++)this.videoJS.removeRemoteTextTrack(b[a])};return c}(),N=function(){function c(b,a){var f=this;
this.libs=a;this.commands=[];b.then(function(a){f.playerInstance=a;f.executeCommands()})}c.prototype.executeCommands=function(){for(var b=0;b<this.commands.length;b++)this.commands[b](this.playerInstance)};c.prototype.play=function(b){var a=this;this.playerInstance?this._play(b,this.playerInstance):this.commands.push(function(){for(var f=[],c=0;c<arguments.length;c++)f[c]=arguments[c];return a._play(b,f[0])});return this};c.prototype.mute=function(){var b=this;this.playerInstance?this._mute(this.playerInstance):
this.commands.push(function(){for(var a=[],f=0;f<arguments.length;f++)a[f]=arguments[f];return b._mute(a[0])});return this};c.prototype.unmute=function(){var b=this;this.playerInstance?this._unmute(this.playerInstance):this.commands.push(function(){for(var a=[],f=0;f<arguments.length;f++)a[f]=arguments[f];return b._unmute(a[0])});return this};c.prototype.isMuted=function(){var b=this;if(this.playerInstance)return this._isMuted(this.playerInstance);this.commands.push(function(){for(var a=[],f=0;f<
arguments.length;f++)a[f]=arguments[f];return b._isMuted(a[0])});return!0};c.prototype.getCurrentTime=function(){var b=this;if(this.playerInstance)return this._getCurrentTime(this.playerInstance);this.commands.push(function(){for(var a=[],f=0;f<arguments.length;f++)a[f]=arguments[f];return b._getCurrentTime(a[0])});return 0};c.prototype.setCurrentTime=function(b){var a=this;this.playerInstance?this._setCurrentTime(b,this.playerInstance):this.commands.push(function(){for(var f=[],c=0;c<arguments.length;c++)f[c]=
arguments[c];return a._setCurrentTime(b,f[0])})};c.prototype.getMediaDuration=function(){var b=this;if(this.playerInstance)return this._getMediaDuration(this.playerInstance);this.commands.push(function(){for(var a=[],f=0;f<arguments.length;f++)a[f]=arguments[f];return b._getMediaDuration(a[0])});return 0};c.prototype.pause=function(){var b=this;this.playerInstance?this._pause(this.playerInstance):this.commands.push(function(){for(var a=[],f=0;f<arguments.length;f++)a[f]=arguments[f];return b._pause(a[0])});
return this};c.prototype.resume=function(b){var a=this;this.playerInstance?this._resume(b,this.playerInstance):this.commands.push(function(){for(var f=[],c=0;c<arguments.length;c++)f[c]=arguments[c];return a._resume(b,f[0])});return this};c.prototype.stop=function(){var b=this;this.playerInstance?this._stop(this.playerInstance):this.commands.push(function(){for(var a=[],f=0;f<arguments.length;f++)a[f]=arguments[f];return b._stop(a[0])});return this};c.prototype.seek=function(b){var a=this;this.playerInstance?
this._seek(b,this.playerInstance):this.commands.push(function(){for(var f=[],c=0;c<arguments.length;c++)f[c]=arguments[c];return a._seek(b,f[0])});return this};c.prototype.on=function(b,a){var f=this;this.playerInstance?this._on(b,a,this.playerInstance):this.commands.push(function(){for(var c=[],e=0;e<arguments.length;e++)c[e]=arguments[e];return f._on(b,a,c[0])});return this};c.prototype.off=function(b,a){var f=this;this.playerInstance?this._off(b,a,this.playerInstance):this.commands.push(function(){for(var c=
[],e=0;e<arguments.length;e++)c[e]=arguments[e];return f._off(b,a,c[0])});return this};c.prototype.aspectRatio=function(b){var a=this;this.playerInstance?this._aspectRatio(b,this.playerInstance):this.commands.push(function(){for(var f=[],c=0;c<arguments.length;c++)f[c]=arguments[c];return a._aspectRatio(b,f[0])});return this};c.prototype.getCurrent=function(){if(this.playerInstance)return this.playerInstance.getCurrent()};c.prototype.getPosition=function(){return this.playerInstance?this.playerInstance.getPosition():
0};c.prototype.isPlaying=function(){return this.playerInstance?this.playerInstance.isPlaying():!1};c.prototype.isPaused=function(){return this.playerInstance?this.playerInstance.isPaused():!1};c.prototype.getVersion=function(){return this.playerInstance?this.playerInstance.getVersion():""};c.prototype.destroy=function(){this.playerInstance&&this.playerInstance.destroy();this.playerInstance=null};c.prototype.addChild=function(b,a){this.playerInstance&&this.playerInstance.addChild(b,a);return this};
c.prototype.removeChild=function(b){this.playerInstance&&this.playerInstance.removeChild(b);return this};c.prototype.loadNextVideoPoster=function(b){this.playerInstance&&this.playerInstance.loadNextVideoPoster(b);return this};c.prototype.updateTextTrack=function(b){this.playerInstance&&this.playerInstance.updateTextTrack(b);return this};c.prototype.blur=function(){this.playerInstance&&this.playerInstance.blur();return this};c.prototype.requestFullscreen=function(){this.playerInstance&&this.playerInstance.requestFullscreen();
return this};c.prototype.exitFullscreen=function(){this.playerInstance&&this.playerInstance.exitFullscreen();return this};c.prototype.isFullscreen=function(){return this.playerInstance?this.playerInstance.isFullscreen():!1};c.prototype.fluid=function(b){this.playerInstance&&this.playerInstance.fluid(b);return this};c.prototype.enableCurrentTextTrack=function(b){void 0===b&&(b="en");this.playerInstance&&this.playerInstance.enableCurrentTextTrack(b)};c.prototype.disableCurrentTextTrack=function(b){void 0===
b&&(b="en");this.playerInstance&&this.playerInstance.disableCurrentTextTrack(b)};c.prototype._play=function(b,a){b?a.play(b):a.play()};c.prototype._mute=function(b){b.mute()};c.prototype._unmute=function(b){b.unmute()};c.prototype._isMuted=function(b){return b.isMuted()};c.prototype._getCurrentTime=function(b){return b.getCurrentTime()};c.prototype._setCurrentTime=function(b,a){a.setCurrentTime(b)};c.prototype._getMediaDuration=function(b){return b.getMediaDuration()};c.prototype._pause=function(b){b.pause()};
c.prototype._stop=function(b){b.stop()};c.prototype._resume=function(b,a){a.resume(b)};c.prototype._seek=function(b,a){a.seek(b)};c.prototype._on=function(b,a,f){f.on(b,a)};c.prototype._off=function(b,a,f){f.off(b,a)};c.prototype._destroy=function(b){b.destroy()};c.prototype._aspectRatio=function(b,a){a.aspectRatio(b)};return c}(),O=function(){function c(b){this.deps=b}c.prototype.create=function(b){var a=this,f=t(),c=new this.deps.promise(function(a,b){h[f]={resolve:a,reject:b}});q.when("brila").execute("construct-player",
function(a){h[f].resolve(a)});var e=document.getElementById(b.containerId),g=b.containerId+"-container";e.innerHTML='\x3cdiv id\x3d"'+g+'" style\x3d"width:100%; height:100%"\x3e\x3c/div\x3e';e=(new this.deps.promise(function(f,e){c.then(function(d){var c=new M(d,V(b,g),b.initialVideo,a.deps);c.on("playerLoaded",function(){f(c)})})})).then(function(a){return a});return new L(new N(e,this.deps),document.getElementById(g),this.deps)};return c}(),F=function(c,b){return b={exports:{}},c(b,b.exports),b.exports}(function(c){function b(){}
function a(a,b,f){this.fn=a;this.context=b;this.once=f||!1}function f(){this._events=new b;this._eventsCount=0}var e=Object.prototype.hasOwnProperty,r="~";Object.create&&(b.prototype=Object.create(null),(new b).__proto__||(r=!1));f.prototype.eventNames=function(){var a=[],b,f;if(0===this._eventsCount)return a;for(f in b=this._events)e.call(b,f)&&a.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(b)):a};f.prototype.listeners=function(a,b){a=this._events[r?
r+a:a];if(b)return!!a;if(!a)return[];if(a.fn)return[a.fn];b=0;for(var f=a.length,d=Array(f);b<f;b++)d[b]=a[b].fn;return d};f.prototype.emit=function(a,b,f,d,c,e){var m=r?r+a:a;if(!this._events[m])return!1;var m=this._events[m],h=arguments.length,l,k;if(m.fn){m.once&&this.removeListener(a,m.fn,n,!0);switch(h){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,b),!0;case 3:return m.fn.call(m.context,b,f),!0;case 4:return m.fn.call(m.context,b,f,d),!0;case 5:return m.fn.call(m.context,
b,f,d,c),!0;case 6:return m.fn.call(m.context,b,f,d,c,e),!0}k=1;for(l=Array(h-1);k<h;k++)l[k-1]=arguments[k];m.fn.apply(m.context,l)}else{var p=m.length,q;for(k=0;k<p;k++)switch(m[k].once&&this.removeListener(a,m[k].fn,n,!0),h){case 1:m[k].fn.call(m[k].context);break;case 2:m[k].fn.call(m[k].context,b);break;case 3:m[k].fn.call(m[k].context,b,f);break;case 4:m[k].fn.call(m[k].context,b,f,d);break;default:if(!l)for(q=1,l=Array(h-1);q<h;q++)l[q-1]=arguments[q];m[k].fn.apply(m[k].context,l)}}return!0};
f.prototype.on=function(b,f,c){f=new a(f,c||this);b=r?r+b:b;this._events[b]?this._events[b].fn?this._events[b]=[this._events[b],f]:this._events[b].push(f):(this._events[b]=f,this._eventsCount++);return this};f.prototype.once=function(b,f,c){f=new a(f,c||this,!0);b=r?r+b:b;this._events[b]?this._events[b].fn?this._events[b]=[this._events[b],f]:this._events[b].push(f):(this._events[b]=f,this._eventsCount++);return this};f.prototype.removeListener=function(a,f,c,d){a=r?r+a:a;if(!this._events[a])return this;
if(!f)return 0===--this._eventsCount?this._events=new b:delete this._events[a],this;var e=this._events[a];if(e.fn)e.fn!==f||d&&!e.once||c&&e.context!==c||(0===--this._eventsCount?this._events=new b:delete this._events[a]);else{for(var m=0,x=[],k=e.length;m<k;m++)(e[m].fn!==f||d&&!e[m].once||c&&e[m].context!==c)&&x.push(e[m]);x.length?this._events[a]=1===x.length?x[0]:x:0===--this._eventsCount?this._events=new b:delete this._events[a]}return this};f.prototype.removeAllListeners=function(a){a?(a=r?
r+a:a,this._events[a]&&(0===--this._eventsCount?this._events=new b:delete this._events[a])):(this._events=new b,this._eventsCount=0);return this};f.prototype.off=f.prototype.removeListener;f.prototype.addListener=f.prototype.on;f.prototype.setMaxListeners=function(){return this};f.prefixed=r;f.EventEmitter=f;"undefined"!==typeof c&&(c.exports=f)}).EventEmitter,k=function(){function c(){}c.POSITIVE_VOTE="positive";c.NEGATIVE_VOTE="negative";c.NONE_VOTE="none";c.EMPTY_STRING="";c.DEFAULT_MIN_GUTTER=
24;c.DEFAULT_HEIGHT_ANIMATION_SPEED=200;c.ATTR_ANIMATING="animating";c.ATTR_CURRENT_GUTTER="currentGutter";c.ATTR_FIRST_ITEM_FLUSH_LEFT="first_item_flush_left";c.ATTR_FIRST_VISIBLE_ITEM="firstVisibleItem";c.ATTR_HEIGHT_ANIMATION_SPEED="height_animation_speed";c.ATTR_HIDE_OFFSCREEN="hide_off_screen";c.ATTR_MAX_HEIGHT="maxHeight";c.ATTR_MIN_GUTTER="minimum_gutter_width";c.ATTR_PAGE_NUMBER="pageNumber";c.ATTR_PAGE_SIZE="pageSize";c.ATTR_SET_SIZE="set_size";c.ATTR_SHOW_PARTIAL="show_partial_next";c.ATTR_SINGLE_PAGE_ALIGN=
"single_page_align";c.ATTR_TOTAL_PAGES="totalPages";c.FIRST_PAGE="first-page";c.LAST_PAGE="last-page";c.$VSE_DISPLAY_STRATEGY_ELEMENT=".a-carousel-display-vse";c.$GROUP_1=".segment-title-G1";c.$GROUP_2=".segment-title-G2";c.VIP_CAROUSEL_CSS_CLASS="vse-vip-lb-carousel";return c}(),G=function(){function c(b,a){this.element=b;this.videoVoteConfig=a;this.countsFetched=!1;this.positiveVoteCount=0;this.showPositiveVotes=!1;this.negativeVoteCount=0;this.showNegativeVotes=!1;this.prompt=b.find(".vse-vote-helpful-text");
this.positiveVoteText=b.find(".vse-vote-positive");this.positiveVoteIcon=b.find(".vse-vote-positive-icon");this.negativeVoteText=b.find(".vse-vote-negative");this.negativeVoteIcon=b.find(".vse-vote-negative-icon");this.previousVote=k.EMPTY_STRING}c.prototype.getVoteCount=function(b){return b===k.POSITIVE_VOTE?this.positiveVoteCount:b===k.NEGATIVE_VOTE?this.negativeVoteCount:0};c.prototype.setVoteCount=function(b,a){0>a&&(a=0);b===k.POSITIVE_VOTE?(this.positiveVoteCount=a,this.positiveVoteText.html(String(a))):
b===k.NEGATIVE_VOTE&&(this.negativeVoteCount=a,this.negativeVoteText.html(String(a)));this.element.addClass("updated")};c.prototype.getPreviousVote=function(){return this.previousVote};c.prototype.setPreviousVote=function(b){if(b===k.POSITIVE_VOTE)this.positiveVoteIcon.addClass("hasvoted"),this.negativeVoteIcon.removeClass("hasvoted"),0>=this.getVoteCount(k.POSITIVE_VOTE)&&this.setVoteCount(k.POSITIVE_VOTE,1);else if(b===k.NEGATIVE_VOTE)this.negativeVoteIcon.addClass("hasvoted"),this.positiveVoteIcon.removeClass("hasvoted"),
0>=this.getVoteCount(k.NEGATIVE_VOTE)&&this.setVoteCount(k.NEGATIVE_VOTE,1);else if(b===k.NONE_VOTE)this.negativeVoteIcon.removeClass("hasvoted"),this.positiveVoteIcon.removeClass("hasvoted");else return;this.previousVote=b};c.prototype.setContentId=function(b){this.contentId=b};c.prototype.getContentId=function(){return this.contentId};c.prototype.showOrHide=function(b,a,f,c){this.showPositiveVotes=b;this.showNegativeVotes=a;this.showPrompt=f;b?(this.positiveVoteText.addClass("show"),this.positiveVoteIcon.addClass("show")):
(this.positiveVoteText.removeClass("show"),this.positiveVoteIcon.removeClass("show"));a?(this.negativeVoteText.addClass("show"),this.negativeVoteIcon.addClass("show")):(this.negativeVoteText.removeClass("show"),this.negativeVoteIcon.removeClass("show"));f?this.prompt.addClass("show"):this.prompt.removeClass("show");c?this.element.addClass("show"):this.element.removeClass("show")};c.prototype.updateWithNewVote=function(b){if(b===k.POSITIVE_VOTE||b===k.NEGATIVE_VOTE){var a=b==k.POSITIVE_VOTE?k.NEGATIVE_VOTE:
k.POSITIVE_VOTE,f=this.getVoteCount(b),c=this.getVoteCount(a);b===this.getPreviousVote()?(this.setPreviousVote(k.NONE_VOTE),this.setVoteCount(b,f-1)):this.getPreviousVote()!==k.EMPTY_STRING&&this.getPreviousVote()!==k.NONE_VOTE?(this.setVoteCount(a,c-1),this.setVoteCount(b,f+1),this.setPreviousVote(b)):(this.setPreviousVote(b),this.setVoteCount(b,f+1))}};return c}(),Y=function(){return function(c,b,a){this.contentId=c;this.positiveVoteCount=b;this.negativeVoteCount=a}}(),P=function(){function c(b,
a){this.A=b;this.videoVoteConfig=a}c.prototype.createFromContent=function(b,a){b=this.A.$("#"+b).find('[.vse-video-votes][data-contentid\x3d"'+a+'"]');return new G(b,this.videoVoteConfig)};c.prototype.createFromSelector=function(b){var a=this.A.$(""+b);if(!a)throw new D("VideoVoteContainerFactory can not find selector by the name of "+b+".");return new G(a,this.videoVoteConfig)};c.prototype.sendVoteToRemote=function(b,a,f){var c=this,e=this.getBasicPayload(this.videoVoteConfig),g=this.A.$.extend(e,
{contentId:f,positive:b,negative:a});return new this.videoVoteConfig.dependencies.promise(function(a,b){y.sendRequest(c.A,"/vap/ew/subcomponent/votes/writing",g,function(b){a(b)},function(a){l.count("vse:votecast:failed",1);b(a)})})};c.prototype.fetchVoteHistory=function(b){var a=this,f=this.getBasicPayload(this.videoVoteConfig),c=this.A.$.extend(f,{contentId:b});return new this.videoVoteConfig.dependencies.promise(function(b,f){y.sendRequest(a.A,"/vap/ew/subcomponent/votes/status",c,function(a){b(a)},
function(a){l.count("vse:votehistory:failed",1);f(a)})})};c.prototype.convertPayloadToVoteData=function(b){var a=[],f;for(f in b)b.hasOwnProperty(f)&&a.push(new Y(f,b[f].positive,b[f].negative));return a};c.prototype.fetchVoteCounts=function(b){var a=this,f=this.getBasicPayload(this.videoVoteConfig),c=this.A.$.extend(f,{contentIds:b});return new this.videoVoteConfig.dependencies.promise(function(b,f){y.sendRequest(a.A,"/vap/ew/subcomponent/votes",c,function(c){c=a.convertPayloadToVoteData(c);0<c.length&&
b(c);f(c)},function(a){l.count("vse:votegetcounts:failed",1);f(a)})})};c.prototype.getBasicPayload=function(b){return{placement:b.placementContext,requestId:b.requestId,sessionId:b.sessionId,page:b.page,bypassLogin:b.forceTreatment||!1}};return c}(),Q=function(){function c(b){this.config=b;this.$stickies=null;this.$container=this.config.A.$(this.config.stickyHeaderContainer);this.$lbContainer=this.config.A.$(this.config.stickyHeaderLBContainer);this.lbModalContainer=this.config.lbModalContainer;this.gutter=
this.$container.offset().top;this.topPosition=this.$container.offset().top-this.$lbContainer.closest(this.lbModalContainer).offset().top}c.prototype.load=function(b){if("object"===typeof b&&0<b.length){var a=this;this.$stickies=b.each(function(b){b=a.config.A.$(this).parents(".vse-follow-wrap").length?a.config.A.$(this):a.config.A.$(this).wrap('\x3cdiv class\x3d"vse-follow-wrap" /\x3e');b.data("originalPosition",b.offset().top+a.$container.scrollTop()-a.gutter).data("originalHeight",b.outerHeight()).parent().height(b.outerHeight(!0))});
this.$container.unbind("scroll");this.$container.bind("scroll",function(){a._whenScrolling()});this.$container.scroll()}};c.prototype._whenScrolling=function(){var b=this;this.$stickies.each(function(a){a=b.config.A.$(this);var f=a.data("originalPosition"),c=b.$container.scrollTop();f<=c?a.addClass("vse-absolute").css({top:c}):a.removeClass("vse-absolute").removeAttr("style")})};return c}(),Z=function(){return function(c){var b=this;this.config=c;this.getTabs=function(){return b.tabs};this.updateSegmentTabForVideo=
function(a){b.config.A.$(""+b.segmentTabCssClassSelectorName).removeClass("vse-tab-active vse-tab-no-border");for(var f=0;f<b.tabs.length&&a>=b.tabs[f].startIndex;++f);b.config.A.$(b.segmentTabCssClassSelectorName+".tab-"+(0<f?f-1:0)).addClass("vse-tab-active vse-tab-with-border")};this.updateSegmentTabOnClick=function(a){b.config.A.$(""+b.segmentTabCssClassSelectorName).removeClass("vse-tab-with-border").addClass("vse-tab-no-border");b.config.A.$(b.segmentTabCssClassSelectorName+"."+a.cssClassName).addClass("vse-tab-with-border")};
this.tabs=c.segmentTabs||[];this.segmentTabCssClassSelectorName=this.config.segmentTabCssClassSelectorName}}(),aa=function(){function c(b,a,f,c,e){var g=this;this.carouselFramework=a;this.A=f;this.contentCarouselConfig=c;this.deps=e;this.vseAssets=[];this.vseAssetIndex={};this.voteContainerIndex={};this.carouselPageSize=this.carouselTotalPages=0;this.carouselPageNumber=1;this.getplaylist=function(){return g.vseAssets.slice()};this.getActiveAsset=function(){return g.activeAsset};this.scrollTo=function(){if(g.contentCarouselConfig.hasStickyHeaders){var a=
g.A.$("#"+g.contentCarouselConfig.carouselName).closest(".vse-lb-right"),b=0;0===g.activeCard.find(".vse-vc-header.first-item").length&&(b=g.A.$(".vse-follow-wrap").first().height()-2);a.animate({scrollTop:g.activeCard.offset().top-a.offset().top+a.scrollTop()-b})}else g.A.$("#"+g.contentCarouselConfig.carouselName).animate({scrollTop:g.activeCard.offset().top-g.A.$("#"+g.contentCarouselConfig.carouselName).offset().top+g.A.$("#"+g.contentCarouselConfig.carouselName).scrollTop()})};this.rotateTo=
function(a){g.markPlaying(a);g.contentCarouselConfig.isVerticalScroll&&g.scrollTo();0!==g.carouselPageSize&&(a=g.findIndex(a),-1!==a&&(a=Math.floor(a/g.carouselPageSize)+1,g.carouselPageNumber!=a&&("none"==g.auiCarousel.getAttr("transitionStrategy")?g.animateCarousel(a-1):g.auiCarousel.gotoPage(a))))};this.markPlaying=function(a){g.activeAsset=a;g.activeCard.removeClass("active");g.activeCard=g.vseAssetIndex[a.contentId].$el.closest("li").addClass("active")};this.findIndex=function(a){return g.vseAssets.indexOf(g.vseAssetIndex[a.contentId])};
this.emitRefTag=function(a,b){0<g.listOffset&&(a=(a-g.listOffset+g.vseAssets.length)%g.vseAssets.length);g.refTagRecorder.emitRefTag(b+a)};this.destroy=function(){g.A.$("#"+g.contentCarouselConfig.carouselName+" .a-carousel-card.active").removeClass("active")};this.updateVotingElements=function(a,b){g.A.each(a,function(a){var f=g.vseAssetIndex[a.contentId].videoVoteContainer;f.setVoteCount(k.POSITIVE_VOTE,a.positiveVoteCount);f.setVoteCount(k.NEGATIVE_VOTE,a.negativeVoteCount);f.countsFetched=!0;
f.showOrHide(b,b,!1,b)})};this.attachStickyHeader=function(a){g.stickyHeaders=new Q(a);g.stickyHeaders.load(g.A.$(a.stickyHeaderContainer+" .vse-vc-header.first-item"))};this.initializeSegmentTabs=function(a){g.segmentTabsModule=new Z(a);g.segmentTabs=g.segmentTabsModule.getTabs();g.attachTabClickHandlers();g.attachTabChangeHandlerOnCarouselScroll();g.showCustomerProfiles()};this.showCustomerProfiles=function(){var a="#"+g.contentCarouselConfig.carouselName+"."+k.VIP_CAROUSEL_CSS_CLASS+" .vse-video-card";
g.A.$(a).each(function(a,b){a=g.A.$(b).find(".vse-video-customer-profile");b=g.A.$(b).find(".vse-video-labels");0<a.length&&0<b.length&&b.html(a.removeClass("aok-hidden").detach().get(0).outerHTML)});g.A.$(a+" .vse-profile").click(function(a){a.stopPropagation();a.stopImmediatePropagation()})};this.attachTabClickHandlers=function(){g.segmentTabs.forEach(function(a){var b=g.A.$(g.segmentTabsModule.segmentTabCssClassSelectorName+"."+a.cssClassName);b.click(function(){g.animateCarousel(a.startIndex);
b.hasClass("vse-tab-active")||g.segmentTabsModule.updateSegmentTabOnClick(a)})})};this.attachTabChangeHandlerOnCarouselScroll=function(){g.A.$("#"+g.contentCarouselConfig.carouselName+"."+k.VIP_CAROUSEL_CSS_CLASS+" .a-carousel-viewport").scroll(function(){g.A.$("#"+g.contentCarouselConfig.carouselName+"."+k.VIP_CAROUSEL_CSS_CLASS+" .vse-video-card").each(function(a,b){g.orientationConfig.getCardInViewOffset(g.A.$(b))<=g.orientationConfig.getOffsetPointForTabUpdate()&&g.segmentTabsModule.updateSegmentTabForVideo(a)})})};
this.animateCarousel=function(a){g.A.objectIsEmpty(g.orientationConfig)||(a*=g.orientationConfig.animatedCarouselDimensionValue(),g.auiCarousel.dom.$viewport.animate(g.orientationConfig.getCarouselPropertyToAnimate(a),500))};this.scrollToActiveVideo=function(a){a=g.findIndex(a);g.animateCarousel(a)};this.updateSegmentTabForActiveVideo=function(a){a=g.findIndex(a);g.segmentTabsModule.updateSegmentTabForVideo(a)};this.setOrientationConfig=function(a){g.orientationConfig=a};this.getAssetSpec=function(a,
b,f){var c=a.data(),e=a.find(".vse-video-image").data("img"),e=e.replace("SR160,90_BG0,0,0_PKvse-overlay-play2","").replace("SR320,180_BG0,0,0_PKvse-overlay-play2",""),m=[];if(c.closedCaptions)for(var r=c.closedCaptions.split(","),h=0;h<r.length-1;h+=2)m.push({locale:r[h],url:r[h+1]});return{index:b,contentId:c.asin,title:c.title,vendorName:c.vendorName,vendorCode:c.vendorCode,referenceUrl:c.referenceUrl,referenceLinkTitle:c.referenceTitle,videoUrl:c.videoUrl,$el:a,duration:c.duration,imageUrl:e,
sponsored:c.sponsored,videoVoteContainer:g.voteContainerIndex[c.asin],productAsin:c.productAsin,refTag:f+b,relatedProducts:c.relatedProducts,vendorTrackingId:c.vendorTrackingId,videoReferenceId:c.videoRefId,groupType:c.groupType,impressionRecorded:!1,closedCaptions:m,creatorType:c.creatorType}};var h=f.$;this.activeCard=h([]);var l=this;this.auiCarousel=b;this.refTagRecorder=new J(f);h("#"+c.carouselName).find(".a-carousel-heading").after(h("#"+c.carouselName).find(".vse-upload-link").removeClass("aok-hidden"));
h("#"+c.carouselName+" .vse-video-item").each(function(a){a=l.getAssetSpec(h(this),a,l.contentCarouselConfig.refTagPrefix);l.vseAssets.push(a);l.vseAssetIndex[a.contentId]=a});c.showVideoVotes&&c.videoVoteConfig&&(this.videoVoteContainerFactory=new P(f,c.videoVoteConfig),f.each(this.vseAssetIndex,function(a){g.voteContainerIndex[a.contentId]=g.videoVoteContainerFactory.createFromContent(g.contentCarouselConfig.carouselName,a.contentId);a.videoVoteContainer=g.voteContainerIndex[a.contentId]}));h("#"+
c.carouselName+" .vse-video-card").find(k.$GROUP_1).first().addClass("first-item");h("#"+c.carouselName+" .vse-video-card").find(k.$GROUP_2).first().addClass("first-item");h("#"+c.carouselName).delegate(".a-carousel-card a","click",function(a){if(h(this).closest("li").hasClass("active"))a.preventDefault();else{var b=l.vseAssetIndex[h(this).closest("li").find(".vse-video-item").data("asin")];l.markPlaying(b);b.eventTimestamp=Date.now();f.trigger("vse:contentCarousel:"+c.carouselName+":click",b);b=
l.findIndex(b);l.emitRefTag(b,l.contentCarouselConfig.refTagPrefix);c.isPreventDefault&&a.preventDefault()}});h("#"+c.carouselName+" .vse-carousel-item").each(function(a){var b=h(this);b.attr("href",b.data("redirect-url")+"?ref\x3d"+l.contentCarouselConfig.refTagPrefix+a)});f.off("a:carousel:"+c.carouselName+":change:pageSize");f.off("a:carousel:"+c.carouselName+":change:pageNumber");f.on("a:carousel:"+c.carouselName+":change:pageSize",function(){g.carouselPageSize=g.auiCarousel.getAttr("pageSize");
g.activeAsset&&g.rotateTo(g.activeAsset)});f.trigger("a:carousel:"+c.carouselName+":change:pageSize");f.on("a:carousel:"+c.carouselName+":change:pageNumber",function(a){var b=a.carousel;a=a.newValue;var e=b.getAttr("totalPages");b.dom.$carousel.closest(k.$VSE_DISPLAY_STRATEGY_ELEMENT).toggleClass(k.FIRST_PAGE,1===a);b.dom.$carousel.closest(k.$VSE_DISPLAY_STRATEGY_ELEMENT).toggleClass(k.LAST_PAGE,a===e);g.carouselPageNumber=g.auiCarousel.getAttr("pageNumber");f.trigger("a:carousel:"+c.carouselName+
":scrollCarousel",g.carouselPageNumber,g.carouselPageSize)});f.trigger("a:carousel:"+c.carouselName+":updatePageIndex",this.carouselPageNumber,this.carouselPageSize);f.declarative(c.carouselName+"-sm-link","click touch",function(a){h("#"+c.carouselName+" .vse-video-item .vse-carousel-item").first().click()})}c.prototype.changeStartingCardTo=function(b){var a=this;this.listOffset=this.findIndex(b);var f=this;this.A.$("#"+this.contentCarouselConfig.carouselName+" .vse-carousel-item").each(function(a){var b=
f.A.$(this);a=(a-f.listOffset+f.vseAssets.length)%f.vseAssets.length;b.attr("href",b.data("redirect-url")+"?ref\x3d"+f.contentCarouselConfig.refTagPrefix+a)});this.contentCarouselConfig.isVerticalScroll||(this.carouselFramework.initializeAll(),this.carouselFramework.onInit(""+this.contentCarouselConfig.carouselName,function(){a.rotateTo(b)}))};return c}(),H=function(){function c(b,a,f){this.carouselFramework=b;this.A=a;this.deps=f}c.prototype.create=function(b){var a=this.carouselFramework.getCarousel(this.A.$("#"+
b.carouselName));if(!a)throw new D("Carousel framework can not find carousel by the name of "+b.carouselName+".");return new aa(a,this.carouselFramework,this.A,b,this.deps)};return c}(),ba={BrilaFactory:O,VSEPlayer:L,BrilaShim:M,PlayerPromiseShim:N,GatedP:z,PostMetric:l,AuiUtils:v,EventEmitter:F,VideoVoteContainer:G,ContentCarouselFactory:H,InvalidArgumentsException:D,guid:t,StickyHeaders:Q,RefTagRecorder:J},e=function(){function c(){}c.PLAYER_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-player-failed-to-render-no-pagestate";
c.LAZY_LOAD_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-lazyload-failed-to-render-no-pagestate";c.RV_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-rv-failed-to-render-no-pagestate";c.INGRESS_RV_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-ingress-failed-to-render-no-pagestate";c.FEEDBACK_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-feedback-failed-to-render-no-pagestate";c.METADATA_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-metadata-failed-to-render-no-pagestate";c.SOCIAL_SHARE_STATE_NOT_FOUND_ERROR_KEY="vse-social-share-failed-to-render-no-pagestate";
c.RELATED_PRODUCT_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-related-product-failed-to-render-no-pagestate";c.LB_POPOVER_NOT_FOUND_ERROR_KEY="vse-lb-failed-to-render-no-popover";c.VISIBLE_DIV_NARROW_PREFIX="vse-pc-visible-narrow-";c.AJAX_MAX_RETRY_COUNT=3;c.VAP_EW="/vap/ew/";c.RELATED_PRODUCTS_ENDPOINT="subcomponent/relatedproducts/";c.EMPTY_STRING="";c.PORTRAIT="portrait";c.LANDSCAPE="landscape";c.SQUARE="square";c.PORTRAIT_ASPECT_RATIO="9:16";c.LANDSCAPE_ASPECT_RATIO="16:9";c.SQUARE_ASPECT_RATIO="1:1";
c.IS_VIDEO_IMMERSIVE_PLAYER_KEY="isVideoImmersivePlayer";c.COMMA=",";c.SEMICOLON=";";c.videoInformationContainer=".vse-lb-video-metadata";c.videoTitle=c.videoInformationContainer+" .vse-content-title";c.vendorName=c.videoInformationContainer+" .vse-video-author";c.ibVideoOspDisclosure=c.videoInformationContainer+" .vse-oap-disclosure";c.socialShareClickMetricName="vseSocialShareClickImageBlock";c.RELATED_PRODUCTS_INNER_CONTAINER=".vse-rp-container";c.RELATED_PRODUCTS_INNER_CLASS_NAME="vse-rp-container";
c.CACHE_RP_PAYLOAD_HIDDEN_DIV_CONTAINER=".vse-related-products-cache-hidden";c.RELATED_PRODUCTS_CONTAINER_SELECTOR=".vse-related-products-narrow";c.RELATED_PRODUCTS_ITEM_SELECTOR=".vse-product-item";c.ATTRIBUTION_NAME="vse-component-assets";c.VIPLightboxSelector=".vse-vip-lightbox";c.VIPOverlaySelector=".vse-vip-overlay";c.VIPActionOverlaySelector=".vse-vip-actions-overlay";c.VIPLbTabsAndCarouselOverlaySelector=".vse-vip-lb-tabs-carousel-container-overlay";c.VIPLbCarouselSelector=".vse-vip-lb-carousel-container";
c.VIPProductCarouselOverlaySelector=".vse-pc-container-overlay";c.VIPLbTabsAndCarouselContainerSelector=".vse-vip-lb-tabs-carousel-container";c.VIPProductCarouselOverlayContainerSelector=".vse-pc-container";c.VIPShopIconSelector=".vse-vip-shop-icon";c.VIPWatchIconSelector=".vse-vip-watch-icon";c.VIPWatchIconBlockSelector=".vse-vip-watch";c.VIPShareIconSelector=".vse-vip-share-icon";c.VIPActionIconSelector=".vse-vip-action-icon";c.VIPEmptyRelatedProductsContainerSelector=".vse-related-products-mobile-empty";
c.VIPLbTabsContainerSelector=".vse-vip-lb-tabs";c.VIPLbCarouselViewportSelector=".vse-vip-lb-carousel .a-carousel-viewport";c.VIPSkipBackButtonSelector=".vse-vip-skip-backward-button";c.VIPSkipForwardButtonSelector=".vse-vip-skip-forward-button";c.VIPPlayPauseToggleSelector=".vse-vip-play-pause-toggle";c.VIPProgressBarSelector=".vse-vip-scrubber-bar";c.VIPProgressBarFillSelector=".vse-vip-scrubber-bar-fill";c.VIPTimeElapsedSelector=".vse-vip-time-elapsed-display";c.VIPTimeRemainingSelector=".vse-vip-time-remaining-display";
c.VIPProductCarouselViewportSelector=".vse-pc-container .a-carousel-viewport";c.VIPCCButtonSelector=".vse-vip-custom-cc-button";c.VIPCCTooltipSelector=".vse-vip-cc-tooltip";c.VIPCCTooltipTextSelector=".vse-vip-cc-tooltip-text";c.defaultPlayerCaptionsOffSelector=".vjs-subs-caps-button .vjs-menu-item:nth-child(1)";c.defaultPlayerCaptionsOnSelector=".vjs-subs-caps-button .vjs-menu-item:nth-child(2)";c.defaultPlayerCCButtonTitleSelector=".vjs-subs-caps-button.vjs-menu-button \x3e button";c.VIPPlayIconClassName=
"vse-vip-play-icon";c.VIPPauseIconClassName="vse-vip-pause-icon";c.VIPLbOverlayShowCssClassName="vse-lb-tabs-overlay-show";c.VIPOverlayShowClassName="vse-overlay-show";c.VIPActionOverlayShowClassName="vse-vip-ao-show";c.VIPActionOverlayBgShadowClassName="vse-carousel-bg-animation";c.VIPMetadataClassName="vse-lb-video-metadata";c.VIPVideoInfoClassName="vse-video-info";c.VIPVideoHelpfulVotesClassName="vse-helpful-votes";c.VIPVideoTitleWrapperClassName="video-title-ellipsis-wrapper";c.VIPPlayPauseClassName=
"vse-vip-play-pause-forward-previous-btns-container";c.VIPScrubberClassName="vse-vip-controls";c.UpNextClassName="vse-up-next";c.UpNextVideoTitleClassName="vse-up-next-video-title";c.UpNextAuthorClassName="vse-up-next-author";c.UpNextCancelClassName="vse-up-next-cancel";c.UpNextElementClassName="vse-upn-element";c.VIPCCButtonUnpressedClassName="vse-cc-unpressed";c.VIPCCButtonPressedClassName="vse-cc-pressed";c.VIPVideoCarouselOpenedClassName="vse-vip-video-carousel-opened";c.VIPProductCarouselOpenedClassName=
"vse-vip-product-carousel-opened";c.METRIC_WIDGET_CLICK=":widget:click";c.METRIC_VIP_OPEN="vip:open";c.METRIC_VIP_CLOSE="vip:close";c.METRIC_PLAY="vip:play:icon:click";c.METRIC_PAUSE="vip:pause:icon:click";c.METRIC_SKIP_FORWARD="vip:skip:forward:icon:click";c.METRIC_SKIP_BACK="vip:skip:back:icon:click";c.METRIC_SHOP_ICON="vip:shop:icon:click";c.METRIC_PFO_CLICK="vip:shop:pfo:click";c.METRIC_PFO_RENDER="vip:shop:pfo:render";c.METRIC_PFO_IMPRESSION="vip:shop:pfo:impression";c.METRIC_WATCH_ICON="vip:watch:icon:click";
c.METRIC_WATCH_THUMBNAIL_CLICK="vip:watch:thumbnail:click";c.METRIC_WATCH_THUMBNAIL_RENDER="vip:watch:thumbnail:render";c.METRIC_WATCH_THUMBNAIL_IMPRESSION="vip:watch:thumbnail:impression";c.METRIC_SHARE_ICON="vip:share:icon:click";c.METRIC_SHARE_SELECTION_CLICK="vip:share:selection:click";c.METRIC_VIP_CC_PRESS_CLICK="vip:cc:press:button:click";c.METRIC_VIP_CC_UNPRESS_CLICK="vip:cc:unpress:button:click";c.METRIC_PLAYER_DEFAULT_CC_ON_CLICK="default:player:cc:on:click";c.METRIC_PLAYER_DEFAULT_CC_OFF_CLICK=
"default:player:cc:off:click";return c}(),ca=function(){return function(c){var b=this;this.config=c;this.setOrientationConfig=function(a){b.orientationConfig=a};this.updateActiveVideoContentId=function(a){b.activeVideoContentId=a};this.handleWatchIconInteractions=function(){b.config.A.$("#"+b.templateId+" "+e.VIPWatchIconSelector+".vse-unpressed").click(function(a){a.stopPropagation();a.stopImmediatePropagation();b.config.A.trigger("vse:"+b.templateId+":vip:vat:component:open");a=function(){b.config.A.$("#"+
b.templateId+" "+e.VIPProductCarouselOverlaySelector).hide();b.config.A.$("#"+b.templateId+" "+e.VIPProductCarouselOverlayContainerSelector).addClass(e.VIPActionOverlayBgShadowClassName);b.toggleIconsState(!0,e.VIPWatchIconSelector);b.toggleIconsState(!1,e.VIPShopIconSelector);h.innerWidth>h.innerHeight&&b.config.A.$("#"+b.templateId+" "+e.VIPLbCarouselViewportSelector).height(h.innerHeight-b.config.A.$("#"+b.templateId+" "+e.VIPLbTabsContainerSelector).outerHeight(!0));b.config.A.$("#"+b.templateId+
" "+e.VIPLbTabsAndCarouselOverlaySelector).addClass(e.VIPLbOverlayShowCssClassName);b.config.A.$("#"+b.templateId+" "+e.VIPLbTabsAndCarouselContainerSelector).removeClass(e.VIPActionOverlayBgShadowClassName);b.config.A.fadeIn(b.config.A.$("#"+b.templateId+" "+e.VIPLbTabsContainerSelector),300,"linear");b.config.A.$("#"+b.templateId+" "+e.VIPLbCarouselSelector).animate(b.orientationConfig.carouselAnimationType,300,function(){b.lightboxCarousel.scrollToActiveVideo(b.lightboxCarousel.getActiveAsset())});
b.config.A.$("#"+b.templateId+" .vjs-text-track-display").addClass(e.VIPVideoCarouselOpenedClassName)};b.isDisplayed(e.RELATED_PRODUCTS_CONTAINER_SELECTOR)?b.closeProductCarousel(a):a()})};this.handleShopIconInteractions=function(){b.config.A.$("#"+b.templateId+" "+e.VIPShopIconSelector+".vse-unpressed").click(function(a){a.stopPropagation();a.stopImmediatePropagation();b.config.A.trigger("vse:"+b.templateId+":vip:vat:component:open");a=function(){b.config.A.$("#"+b.templateId+" "+e.VIPLbTabsAndCarouselOverlaySelector).removeClass(e.VIPLbOverlayShowCssClassName);
b.config.A.$("#"+b.templateId+" "+e.VIPLbTabsAndCarouselContainerSelector).addClass(e.VIPActionOverlayBgShadowClassName);b.toggleIconsState(!0,e.VIPShopIconSelector);b.toggleIconsState(!1,e.VIPWatchIconSelector);b.config.A.$("#"+b.templateId+" "+e.RELATED_PRODUCTS_CONTAINER_SELECTOR).removeClass("aok-hidden");b.config.A.$("#"+b.templateId+" "+e.VIPProductCarouselOverlaySelector).show();b.config.A.$("#"+b.templateId+" "+e.VIPProductCarouselOverlayContainerSelector).removeClass(e.VIPActionOverlayBgShadowClassName);
b.config.A.$("#"+b.templateId+" "+e.RELATED_PRODUCTS_CONTAINER_SELECTOR).animate(b.orientationConfig.carouselAnimationType,300);b.config.A.$("#"+b.templateId+" .vjs-text-track-display").addClass(e.VIPProductCarouselOpenedClassName)};b.isDisplayed(e.VIPLbCarouselSelector)?b.closeVideoCarousel(a):a()})};this.toggleIconsState=function(a,f){a?(b.config.A.$("#"+b.templateId+" "+f+".vse-unpressed").addClass("aok-hidden"),b.config.A.$("#"+b.templateId+" "+f+".vse-pressed").removeClass("aok-hidden")):(b.config.A.$("#"+
b.templateId+" "+f+".vse-unpressed").removeClass("aok-hidden"),b.config.A.$("#"+b.templateId+" "+f+".vse-pressed").addClass("aok-hidden"))};this.handleVIPCarouselClose=function(){[e.VIPLbCarouselSelector,e.VIPLbTabsContainerSelector,e.RELATED_PRODUCTS_CONTAINER_SELECTOR].forEach(function(a){b.config.A.$(b.config.A.$("#"+b.templateId+" "+a)).click(function(a){b.config.A.$(a.target).closest(e.RELATED_PRODUCTS_ITEM_SELECTOR).length||(a.stopPropagation(),a.stopImmediatePropagation())})});b.config.A.$("#"+
b.templateId+" "+e.VIPActionOverlaySelector).click(function(){b.reset();b.config.A.trigger("vse:"+b.templateId+":vip:vat:component:close")})};this.handleShareIconInteractions=function(){b.config.A.off("a:sheet:beforeShow:"+b.socialShareId+"-sheet");b.config.A.off("a:sheet:afterHide:"+b.socialShareId+"-sheet");b.config.A.on("a:sheet:beforeShow:"+b.socialShareId+"-sheet",function(){b.config.A.trigger("vse:"+b.templateId+":vip:vat:component:open");b.toggleIconsState(!0,e.VIPShareIconSelector)});b.config.A.on("a:sheet:afterHide:"+
b.socialShareId+"-sheet",function(){b.config.A.trigger("vse:"+b.templateId+":vip:vat:component:close");b.toggleIconsState(!1,e.VIPShareIconSelector)})};this.reset=function(){b.unpressAllActionIcons();b.isDisplayed(e.VIPLbCarouselSelector)&&b.closeVideoCarousel(function(){b.config.A.$("#"+b.templateId+" "+e.VIPLbTabsAndCarouselContainerSelector).addClass(e.VIPActionOverlayBgShadowClassName);b.config.A.delay(function(){b.config.A.$("#"+b.templateId+" "+e.VIPLbTabsAndCarouselOverlaySelector).removeClass(e.VIPLbOverlayShowCssClassName)},
310)});b.isDisplayed(e.RELATED_PRODUCTS_CONTAINER_SELECTOR)&&b.closeProductCarousel(function(){b.config.A.$("#"+b.templateId+" "+e.VIPProductCarouselOverlayContainerSelector).addClass(e.VIPActionOverlayBgShadowClassName);b.config.A.delay(function(){b.config.A.$("#"+b.templateId+" "+e.VIPProductCarouselOverlaySelector).hide()},310)})};this.unpressAllActionIcons=function(){b.config.A.$("#"+b.templateId+" "+e.VIPActionIconSelector+" .vse-pressed").addClass("aok-hidden");b.config.A.$("#"+b.templateId+
" "+e.VIPActionIconSelector+" .vse-unpressed").removeClass("aok-hidden")};this.closeProductCarousel=function(a){b.config.A.$("#"+b.templateId+" "+e.RELATED_PRODUCTS_CONTAINER_SELECTOR).animate(b.orientationConfig.carouselAnimationType,300,a);b.config.A.$("#"+b.templateId+" .vjs-text-track-display").removeClass(e.VIPProductCarouselOpenedClassName)};this.closeVideoCarousel=function(a){b.config.A.fadeOut(b.config.A.$("#"+b.templateId+" "+e.VIPLbTabsContainerSelector),300,"linear");b.config.A.$("#"+b.templateId+
" "+e.VIPLbCarouselSelector).animate(b.orientationConfig.carouselAnimationType,300,a);b.config.A.$("#"+b.templateId+" .vjs-text-track-display").removeClass(e.VIPVideoCarouselOpenedClassName)};this.isDisplayed=function(a){return"block"==b.config.A.$("#"+b.templateId+" "+a).css("display")};this.lightboxCarousel=c.contentCarousel;this.socialShareId=c.socialShareId;this.templateId=c.templateId}}(),R=function(){function c(b){var a=this;this.A=b;this.makeApplicationSushiPayloadBuilder=function(a,b){return I.makeApplicationSushiPayloadBuilder(a,
b)};this.getCurrentlyPlayingVideoInCarousel=function(b){return a.vars.relatedVideosCarousel.getplaylist()[b]};this.getCurrentlyPlayingVideoInCarouselMarkAsPlaying=function(b){b=a.getCurrentlyPlayingVideoInCarousel(b);a.vars.relatedVideosCarousel.markPlaying(b);return b};this.startPlaying=function(b){a.vars.isContinuousPlayFinished=!1;b?a.vars.player.play(b):a.vars.player.play()};this.updateMediaInfo=function(b){a.updateBasicMediaInfo(b.title,b.vendorName);a.isCustomerReviewVideo(b)?(a.dom.$activeVideoTitlePrefix.removeClass("aok-hidden"),
a.dom.$activeVideoCRLink.removeClass("aok-hidden"),a.dom.$activeVideoCRLinkWrapper.removeClass("aok-hidden")):(a.dom.$activeVideoTitlePrefix.addClass("aok-hidden"),a.dom.$activeVideoCRLink.addClass("aok-hidden"),a.dom.$activeVideoCRLinkWrapper.addClass("aok-hidden"));a.vars.shouldShowProfiles&&(a.isInfluencerVideo(b)?a.updateInfluencerProfile(b):a.updateCustomerProfile(b));a.dom.$activeVideoCRLink.attr("href",b.referenceUrl||"");a.vars.showVotes&&!a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)&&
(a.updateActiveVideoVoteContainer(b),a.vars.activeVideoVoteContainer.showOrHide(!0,!0,!0,!0));a.isInfluencerVideo(b)||(a.isOspEnabled(b)?a.dom.$wrapper.find(e.ibVideoOspDisclosure).removeClass("aok-hidden"):a.dom.$wrapper.find(e.ibVideoOspDisclosure).addClass("aok-hidden"))};this.updateCustomerProfile=function(b){b=a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]').find(".vse-video-customer-profile");0<b.length?(a.dom.$activeVideoCustomerProfile.html(b.clone().removeClass("vse-hidden").html()),
a.dom.$videoAuthorBlock.addClass("vse-hidden"),a.dom.$customerProfileContainer.removeClass("vse-no-cp")):(a.dom.$activeVideoCustomerProfile.html(""),a.dom.$videoAuthorBlock.removeClass("vse-hidden"),a.dom.$customerProfileContainer.addClass("vse-no-cp"))};this.updateInfluencerProfile=function(b){var c=a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]').find(".vse-video-influencer-profile");if(0<c.length){c=c.clone();c.find(".a-profile-avatar-wrapper").addClass("vse-hidden");a.dom.$activeVideoCustomerProfile.html(c.removeClass("vse-hidden").html());
var c=a.dom.$wrapper.find(e.ibVideoOspDisclosure).addClass("aok-hidden").clone().removeClass("aok-hidden"),h=a.vars.$("\x3ca\x3e");h.append(c);h[0].href="javascript:void(0);";h.insertAfter(a.dom.$activeVideoCustomerProfile.find(".a-profile-content"));a.dom.$videoAuthorBlock.addClass("vse-hidden");a.dom.$customerProfileContainer.removeClass("vse-no-cp");a.handleInfluencerProfileNameClick(b)}};this.needToUpdateVideoInfoLater=function(){return a.isImageBlockVIP()&&!a.vars.A.objectIsEmpty(a.vars.currentAssetSpec)&&
a.vars.A.objectIsEmpty(a.vars.currentAssetSpec.title)};this.updateVideoMetadataIfNeeded=function(b){a.needToUpdateVideoInfoLater()&&(a.updateBasicMediaInfo(b.title,b.vendorName),a.resetUserActivityTimer(),a.showVideoImmersivePlayerOverlay(),a.vars.showClosedCaptions&&!a.vars.A.objectIsEmpty(b.closedCaptions)&&0<b.closedCaptions.length&&a.vars.player.updateTextTrack(b.closedCaptions))};this.clearCurrentVideoInfo=function(){a.updateBasicMediaInfo("","")};this.updateBasicMediaInfo=function(b,c){a.dom.$wrapper.find(e.videoTitle).text(b);
a.dom.$wrapper.find(e.vendorName).text(c)};this.isImageBlockVIP=function(){return a.vars.isVideoImmersivePlayer&&-1!==a.vars.clientPrefix.indexOf("imageblock")};this.createContinuousPlayPlaylist=function(b){a.vars.playlist=a.vars.relatedVideosCarousel.getplaylist();for(var c=0;c<a.vars.playlist.length&&a.vars.playlist[0].contentId!==b.contentId;c++)a.vars.playlist.push(a.vars.playlist.shift())};this.updateFeedback=function(b){a.vars.A.objectIsEmpty(a.vars.feedback)||a.vars.A.objectIsEmpty(b)||a.vars.feedback.setActiveVideoAndSource(b.contentId,
b.vendorCode)};this.show=function(b){a.updateMediaInfo(b);a.updateFeedback(b);a.showRelatedProducts(b);a.refreshSocialSharePageState(b);a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.vars.relatedVideosCarousel.rotateTo(b);a.vars.isVideoImmersivePlayer&&a.showOrHideClosedCaptions(b)};this.showOrHideClosedCaptions=function(b){a.vars.showClosedCaptions&&b.closedCaptions&&(0<b.closedCaptions.length?a.vars.A.$("#"+a.vars.templateId+" "+e.VIPCCButtonSelector).show():a.vars.A.$("#"+a.vars.templateId+
" "+e.VIPCCButtonSelector).hide())};this.updateActiveVideoVoteContainer=function(b){a.vars.activeVideoVoteContainer.setPreviousVote(k.NONE_VOTE);a.vars.activeVideoVoteContainer.setContentId(b.contentId);a.vars.activeVideoVoteContainer.setVoteCount(k.POSITIVE_VOTE,b.videoVoteContainer.getVoteCount(k.POSITIVE_VOTE));a.vars.activeVideoVoteContainer.setVoteCount(k.NEGATIVE_VOTE,b.videoVoteContainer.getVoteCount(k.NEGATIVE_VOTE));a.fetchAndUpdateVotingCount(b);a.fetchAndUpdateVotingHistory(b)};this.castVote=
function(b){if(a.vars.videoVoteContainerFactory&&a.vars.videoVoteContainerFactory.videoVoteConfig){var c=a.vars.activeVideoVoteContainer.getPreviousVote(),e=b===k.POSITIVE_VOTE&&c!=k.POSITIVE_VOTE,c=b===k.NEGATIVE_VOTE&&c!=k.NEGATIVE_VOTE;a.vars.activeVideoVoteContainer.updateWithNewVote(b);a.vars.videoVoteContainerFactory.sendVoteToRemote(e,c,a.vars.activeVideoVoteContainer.getContentId()).then(function(c){a.vars.videoVoteContainerFactory&&a.vars.videoVoteContainerFactory.videoVoteConfig&&a.vars.A.trigger(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+
"-vote-cast",b)},function(c){l.count(a.vars.clientPrefix+".videovote.votecastfailure",1);a.vars.activeVideoVoteContainer.updateWithNewVote(b)})}};this.fetchAndUpdateVotingCount=function(b){b.videoVoteContainer&&!b.videoVoteContainer.countsFetched&&a.vars.videoVoteContainerFactory.fetchVoteCounts([b.contentId]).then(function(c){a.vars.relatedVideosCarousel.updateVotingElements(c,!1);for(var e=0;e<c.length;e++)if(c[e].contentId===b.contentId){b.videoVoteContainer.setVoteCount(k.POSITIVE_VOTE,c[e].positiveVoteCount);
b.videoVoteContainer.setVoteCount(k.NEGATIVE_VOTE,c[e].negativeVoteCount);b.videoVoteContainer.countsFetched=!0;a.vars.activeVideoVoteContainer.setVoteCount(k.POSITIVE_VOTE,c[e].positiveVoteCount);a.vars.activeVideoVoteContainer.setVoteCount(k.NEGATIVE_VOTE,c[e].negativeVoteCount);break}a.vars.activeVideoVoteContainer.countsFetched=!0;a.vars.activeVideoVoteContainer.showOrHide(!0,!0,!0,!0)},function(b){l.count(a.vars.clientPrefix+".videovote.votecountfailure",1);a.vars.A.trigger(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+
"-hide-votes")})};this.fetchAndUpdateVotingHistory=function(b){b.videoVoteContainer&&(b.videoVoteContainer.getPreviousVote()!==k.EMPTY_STRING?a.vars.activeVideoVoteContainer.setPreviousVote(b.videoVoteContainer.getPreviousVote()):a.vars.videoVoteContainerFactory.fetchVoteHistory(b.contentId).then(function(c){a.vars.videoVoteContainerFactory===n||c!==k.POSITIVE_VOTE&&c!==k.NEGATIVE_VOTE&&c!==k.NONE_VOTE||(a.vars.activeVideoVoteContainer.setPreviousVote(c),b.videoVoteContainer.setPreviousVote(c))},
function(b){l.count(a.vars.clientPrefix+".videovote.votehistoryfailure",1)}))};this.showRelatedProducts=function(b){a.fadeOutRelatedProductsContainer();var c=b.relatedProducts;c!==n&&(a.retrieveRelatedProductsCarouselFromCache(b.contentId)!==n?a.getRelatedProductsFromCache(b.contentId):a.getRelatedProducts(1,c,b.contentId))};this.getRelatedProducts=function(b,c,h){if(b>e.AJAX_MAX_RETRY_COUNT)a.handleGetRelatedProductsFailure();else{var g=!0;0<a.vars.relatedProductsNilgiriRequestCount&&(g=!1);var k=
v.fetchLatestPageState(a.vars.A,a.vars.clientPrefix+"-related-products-request-ps");if(k){var u=k.componentConfiguration,k=k.pageContext;if(u&&k&&u.features&&u.features.features){var d=u.features,g={pageContext:{page:k.page,placement:k.placement,marketplaceID:k.marketplaceID,locale:k.locale,customerId:k.customerId,requestId:k.requestId,product:{contentID:"",contentIDType:"ASIN"},metadata:{relatedProductsAsins:c}},configuration:{id:u.id,type:u.type,binder:u.binder,assets:g?["ProductCarousel"]:[],features:{features:{context:d.features.context,
displayStrategy:d.features.displayStrategy,pagestate:d.features.pagestate,explicitlyEmitPageState:d.features.explicitlyEmitPageState,cssClass:d.features.cssClass,carouselName:d.features.carouselName,isVideoImmersivePlayer:a.vars.isVideoImmersivePlayer}}}};a.vars.relatedProductsRequest=g;y.sendRequest(a.vars.A,""+e.VAP_EW+e.RELATED_PRODUCTS_ENDPOINT,g,function(b){-1!==b.indexOf(e.RELATED_PRODUCTS_INNER_CLASS_NAME)?(a.cacheRelatedProductsPayload(h,b),a.handleGetRelatedProductsSuccess(h),a.vars.$(a.dom.$wrapper).delegate(e.RELATED_PRODUCTS_ITEM_SELECTOR+
" a","click",function(b){b.stopPropagation();b.stopImmediatePropagation();if(a.vars.isVideoImmersivePlayer){var c=a.vars.$(b.target).closest("li").find(e.RELATED_PRODUCTS_ITEM_SELECTOR),f=c.attr("data-asin"),c=c.hasClass("vse-sponsor-product").toString();a.emitPFOClickMetric(e.METRIC_PFO_CLICK,f,c)}b=a.vars.$(b.target).closest("li").find(".vse-carousel-item").attr("href");a.openExternalLinkFromLightBox(b)}),a.A.$("#"+a.vars.templateId+" "+e.VIPProductCarouselViewportSelector).unbind("scroll"),a.A.$("#"+
a.vars.templateId+" "+e.VIPProductCarouselViewportSelector).bind("scroll",a.emitPFOImpressionMetricHandler),a.vars.isVideoImmersivePlayer&&a.emitPFORenderMetric(e.METRIC_PFO_RENDER),l.count(a.vars.clientPrefix+":relatedproducts:load:success",1),a.vars.relatedProductsNilgiriRequestCount+=1):a.handleGetRelatedProductsFailure()},function(d){b+=1;a.getRelatedProducts(b,c,h)})}}else l.count(e.RELATED_PRODUCT_PAGE_STATE_NOT_FOUND_ERROR_KEY,1)}};this.cacheRelatedProductsPayload=function(b,c){b=a.vars.popoverId+
"-vse-pc-hidden-cache-"+b;a.vars.$("#"+a.vars.popoverId+" "+e.CACHE_RP_PAYLOAD_HIDDEN_DIV_CONTAINER).append("\x3cdiv id\x3d'"+b+"'\x3e"+c+" \x3c/div\x3e")};this.retrieveRelatedProductsCarouselFromCache=function(b){b=a.vars.$("#"+a.vars.popoverId+"-vse-pc-hidden-cache-"+b+" "+e.RELATED_PRODUCTS_INNER_CONTAINER);if(b!==n&&b[0]!==n)return b[0].outerHTML};this.handleGetRelatedProductsSuccess=function(b){var c=a.retrieveRelatedProductsCarouselFromCache(b);a.hideCurrentlyVisibleProductContainer();var h=
a.vars.popoverId+"-"+e.VISIBLE_DIV_NARROW_PREFIX+b;a.vars.$("#"+a.vars.popoverId+" "+e.RELATED_PRODUCTS_CONTAINER_SELECTOR).append('\x3cdiv class\x3d"vse-pc-visible aok-hidden" id\x3d\''+h+"'\x3e"+c+"\x3c/div\x3e");a.vars.$("#"+a.vars.popoverId+" "+e.RELATED_PRODUCTS_CONTAINER_SELECTOR+" #"+h+" .a-carousel-left").attr("data-element-id",a.vars.clientPrefix+"-pc-left-button");a.vars.$("#"+a.vars.popoverId+" "+e.RELATED_PRODUCTS_CONTAINER_SELECTOR+" #"+h+" .a-carousel-right").attr("data-element-id",
a.vars.clientPrefix+"-pc-right-button");a.resizeLB();a.showRelatedProductCarousel(b);a.fadeInRelatedProductsContainer(b)};this.getRelatedProductsFromCache=function(b){a.hideCurrentlyVisibleProductContainer();a.showRelatedProductCarousel(b);a.fadeInRelatedProductsContainer(b)};this.hideCurrentlyVisibleProductContainer=function(){a.dom.$relatedProductContainer.find(".vse-pc-visible").addClass("aok-hidden");a.hideVIPProductCarouselEmptyViewContainer()};this.hideVIPProductCarouselEmptyViewContainer=function(){a.vars.isVideoImmersivePlayer&&
a.vars.A.$(e.VIPEmptyRelatedProductsContainerSelector).addClass("aok-hidden")};this.showVIPProductCarouselEmptyViewContainer=function(){a.vars.isVideoImmersivePlayer&&a.vars.A.$(e.VIPEmptyRelatedProductsContainerSelector).removeClass("aok-hidden")};this.showRelatedProductCarousel=function(b){a.vars.A.show(a.vars.$("#"+a.vars.popoverId+" "+e.RELATED_PRODUCTS_CONTAINER_SELECTOR));a.vars.$("#"+a.vars.popoverId+"-"+e.VISIBLE_DIV_NARROW_PREFIX+b).removeClass("aok-hidden")};this.handleGetRelatedProductsFailure=
function(){l.count(a.vars.clientPrefix+":relatedproducts:load:failed",1);a.vars.A.hide(a.vars.$(e.RELATED_PRODUCTS_CONTAINER_SELECTOR));a.vars.isVideoImmersivePlayer&&(a.hideCurrentlyVisibleProductContainer(),a.showVIPProductCarouselEmptyViewContainer())};this.fadeOutRelatedProductsContainer=function(){a.vars.$(e.RELATED_PRODUCTS_CONTAINER_SELECTOR+" "+e.RELATED_PRODUCTS_INNER_CONTAINER).fadeOut(0)};this.fadeInRelatedProductsContainer=function(b){a.vars.$("#"+a.vars.popoverId+"-"+e.VISIBLE_DIV_NARROW_PREFIX+
b+" "+e.RELATED_PRODUCTS_INNER_CONTAINER).animate({opacity:1},0);a.vars.$(e.RELATED_PRODUCTS_CONTAINER_SELECTOR+" "+e.RELATED_PRODUCTS_INNER_CONTAINER).fadeIn(200)};this.showFeedbackLink=function(b,c){a.vars.$(b).css({display:"inline-block"});a.vars.$(c+" video").addClass("dim-video-player")};this.hideFeedbackLink=function(b,c){a.vars.$(b).css({display:"none"});a.vars.$(c+" video").removeClass("dim-video-player")};this.deRegisterFeedback=function(b){a.vars.A.off("vse:"+b+":feedback:shown");a.vars.A.off("vse:"+
b+":feedback:hidden");a.vars.A.off("vse:ns:feedback:"+b+":init:client")};this.setVideoDetails=function(b,c){a.vars.initialVideo={index:0,title:c.videoTitle,vendorName:c.vendorName,contentId:b,vendorCode:c.vendorCode,videoUrl:c.videoUrl,imageUrl:c.imageUrl,productAsin:c.productAsin,videoReferenceId:c.videoReferenceId}};this.attachPlayerEventListeners=function(){a.vars.player&&(a.vars.player.on("playbackComplete",a._playbackCompleteHandler),a.vars.player.on("playbackStart",a._firstFrameHandler))};this.removeUpNextComponent=
function(){a.vars.upNextTimeoutHandle&&clearTimeout(a.vars.upNextTimeoutHandle);a.vars.intervalUserActivityHandlerId=a.userActivityCountDown();a.vars.A.show(a.vars.$("#"+a.vars.templateId+" "+e.videoInformationContainer));a.dom.$wrapper.find("."+e.UpNextElementClassName).addClass("vse-hidden");a.dom.$wrapper.find(e.VIPSkipBackButtonSelector).removeClass("aok-hidden");a.dom.$wrapper.find(e.VIPSkipForwardButtonSelector).removeClass("aok-hidden");a.vars.$("#"+a.vars.templateId+" ."+e.UpNextCancelClassName).unbind("click");
a.vars.vipPlayPauseToggle.toggleClass(e.VIPPlayIconClassName,a.vars.vipControlsShouldPause);a.vars.vipPlayPauseToggle.toggleClass(e.VIPPauseIconClassName,!a.vars.vipControlsShouldPause);a.vars.isUpNextComponentActive=!1};this._playUpNextHandler=function(){if(!a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)){var b=a.vars.relatedVideosCarousel.getActiveAsset(),c=a._getNextAsset(b);c&&(a.vars.vipControlsShouldPause=!1,a.vars.lightBoxPausedVideo=!1,a.removeUpNextComponent(),b.eventTimestamp&&(c.eventTimestamp=
b.eventTimestamp),a.vars.player.play(c),a.show(c))}};this._cancelContinuousPlayHandler=function(){if(!a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)){var b=a.vars.relatedVideosCarousel.getActiveAsset();a.vars.player.loadNextVideoPoster(b.imageUrl);a.vars.vipControlsShouldPause=!0;a.removeUpNextComponent();a.vars.vipControlsShouldPause=!1;a.vars.lightBoxPausedVideo=!0}};this._playbackCompleteHandler=function(){if(!a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)){var b=a.vars.relatedVideosCarousel.getActiveAsset(),
c=a._getNextAsset(b);c?a.vars.useUpNextComponent?(a.vars.isUpNextComponentActive=!0,a.vars.vipControlsShouldPause=!0,a.vars.lightBoxPausedVideo=!0,a.clearIntervalUserActivityHandler(),a.dom.$wrapper.find(e.VIPSkipBackButtonSelector).addClass("aok-hidden"),a.dom.$wrapper.find(e.VIPSkipForwardButtonSelector).addClass("aok-hidden"),a.vars.vipPlayPauseToggle.toggleClass(e.VIPPlayIconClassName,a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(e.VIPPauseIconClassName,!a.vars.vipControlsShouldPause),
a.vars.A.hide(a.vars.$("#"+a.vars.templateId+" "+e.videoInformationContainer)),a.vars.vipControlsShouldPause=!1,a.vars.lightBoxPausedVideo=!1,a.vars.player.loadNextVideoPoster(c.imageUrl),a.dom.$wrapper.find("."+e.UpNextVideoTitleClassName).text(c.title),a.dom.$wrapper.find("."+e.UpNextAuthorClassName).text(c.vendorName),a.dom.$wrapper.find("."+e.UpNextElementClassName).removeClass("vse-hidden"),a.vars.$("#"+a.vars.templateId+" ."+e.UpNextCancelClassName).click(a._cancelContinuousPlayHandler),a.showVideoImmersivePlayerOverlay(),
a.resetUserActivityTimer(-2),a.vars.upNextTimeoutHandle=a.vars.A.delay(function(){a.removeUpNextComponent();b.eventTimestamp&&(c.eventTimestamp=b.eventTimestamp);a.vars.player.play(c);a.show(c)},5E3)):(b.eventTimestamp&&(c.eventTimestamp=b.eventTimestamp),a.vars.player.play(c),a.show(c)):(a.vars.isVideoImmersivePlayer&&(a.clearIntervalUserActivityHandler(),a.vars.lightBoxPausedVideo=!0,a.vars.vipControlsShouldPause=!1,a.vars.vipPlayPauseToggle.toggleClass(e.VIPPauseIconClassName,a.vars.vipControlsShouldPause),
a.vars.vipPlayPauseToggle.toggleClass(e.VIPPlayIconClassName,!a.vars.vipControlsShouldPause),a.showVideoImmersivePlayerOverlay()),a.vars.isContinuousPlayFinished=!0)}};this._firstFrameHandler=function(){a.vars.isMobile&&a.hideFeedbackLink("#vse-"+a.vars.clientPrefix+"-feedback-container","#"+a.vars.containerId+"-container");a.vars.isVideoImmersivePlayer&&(a.vars.player.getMediaDuration()!==a.vars.vipVideoDuration&&(a.vars.vipVideoDuration=a.vars.player.getMediaDuration()),a.vars.vipControlsShouldPause=
!0,a.vars.vipPlayPauseToggle.toggleClass(e.VIPPauseIconClassName,a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(e.VIPPlayIconClassName,!a.vars.vipControlsShouldPause))};this._getNextAsset=function(b){for(var c=0;c<a.vars.playlist.length&&a.vars.playlist[c].contentId!=b.contentId;c++);if(c!=a.vars.playlist.length)return a.vars.playlist[c+1]};this.onPlayerTapHandler=function(){a.showVideoImmersivePlayerOverlay();a.resetUserActivityTimer()};this.pauseVideoIfNeeded=function(){a.vars.player&&
a.vars.player.isPlaying()&&(a.vars.player.pause(),a.vars.lightBoxPausedVideo=!0,a.vars.isVideoImmersivePlayer&&a.vars.isVIPOverlayTimerSet&&a.clearIntervalUserActivityHandler())};this.resumeVideoIfNeeded=function(){a.vars.lightboxOpened&&(a.vars.player&&a.vars.player.isPlaying()&&(a.vars.player.pause(),a.vars.lightBoxPausedVideo=!0),a.vars.player&&!a.vars.player.isPlaying()&&!a.vars.isContinuousPlayFinished&&a.vars.lightBoxPausedVideo&&(a.vars.player.resume(Date.now()),a.vars.isVideoImmersivePlayer&&
!a.vars.isVIPOverlayTimerSet&&(a.resetUserActivityTimer(),a.showVideoImmersivePlayerOverlay(),a.vars.intervalUserActivityHandlerId=a.userActivityCountDown())),a.vars.isVideoImmersivePlayer&&a.vars.isContinuousPlayFinished&&a.vars.initialVideo&&(a.startPlaying(a.vars.initialVideo),a.show(a.vars.initialVideo)),a.vars.lightBoxPausedVideo=!1)};this.setInitialClosedCaptions=function(b,c){var e=[];if(!a.vars.A.objectIsEmpty(c)){c=c.split(",");for(var g=0;g<c.length;g+=2)c[g+1]!==n&&e.push({locale:c[g],
url:c[g+1]})}b.closedCaptions=e};this.setupVIPClosedCaptions=function(b,c){var h="#"+a.vars.templateId+" "+e.VIPCCButtonSelector;a.vars.A.$(h+"."+e.VIPCCButtonUnpressedClassName).live("click",function(){a.vars.A.$(""+h).removeClass(e.VIPCCButtonUnpressedClassName).addClass(e.VIPCCButtonPressedClassName);a.vars.player.enableCurrentTextTrack();a.showTempCCPopup(b.defaultText);a.emitMetric(e.METRIC_VIP_CC_PRESS_CLICK);l.count(e.METRIC_VIP_CC_PRESS_CLICK,1)});a.vars.A.$(h+"."+e.VIPCCButtonPressedClassName).live("click",
function(){a.vars.A.$(""+h).removeClass(e.VIPCCButtonPressedClassName).addClass(e.VIPCCButtonUnpressedClassName);a.vars.player.disableCurrentTextTrack();a.showTempCCPopup(b.captionsOffText);a.emitMetric(e.METRIC_VIP_CC_UNPRESS_CLICK);l.count(e.METRIC_VIP_CC_UNPRESS_CLICK,1)});a.vars.A.objectIsEmpty(c)&&a.vars.A.$(""+h).hide()};this.showTempCCPopup=function(b){a.vars.A.$("#"+a.vars.templateId+" "+e.VIPCCTooltipTextSelector).text(b);a.vars.A.$("#"+a.vars.templateId+" "+e.VIPCCTooltipSelector).removeClass("aok-hidden");
setTimeout(function(){return a.vars.A.$("#"+a.vars.templateId+" "+e.VIPCCTooltipSelector).addClass("aok-hidden")},3E3)};this.setupDefaultClosedCaptionsMetrics=function(){a.vars.A.$("#"+a.vars.templateId+" "+e.defaultPlayerCaptionsOnSelector).click(function(){a.emitMetric(e.METRIC_PLAYER_DEFAULT_CC_ON_CLICK);l.count(e.METRIC_PLAYER_DEFAULT_CC_ON_CLICK,1)});a.vars.A.$("#"+a.vars.templateId+" "+e.defaultPlayerCaptionsOffSelector).click(function(){a.emitMetric(e.METRIC_PLAYER_DEFAULT_CC_OFF_CLICK);l.count(e.METRIC_PLAYER_DEFAULT_CC_OFF_CLICK,
1)});a.vars.A.$("#"+a.vars.templateId+" "+e.defaultPlayerCCButtonTitleSelector).removeAttr("title")};this.constructShareBaseUrl=function(){return(a.vars.A.objectIsEmpty(h.location.origin)?"https://www.amazon.com":h.location.origin)+"/vdp/"};this.refreshSocialSharePageState=function(b){var c="https://www.amazon.com/vdp/"+b.contentId;a.vars.A.objectIsEmpty(a.vars.productAsin)||(c+="?product\x3d"+a.vars.productAsin);a.vars.A.state.replace(a.vars.socialSharePageState,{pageLevelData:{clientRef:"ib",deviceTypeRef:a.vars.isMobile?
"mb":"dt"},url:c,image:b.imageUrl,title:b.title,description:b.title})};this.getMshopShareParams=function(b){var c=a.constructShareBaseUrl()+b.contentId;b=b.title+" "+c;var e="\x3cdiv\x3e \x3cp\x3e"+b+"\x3c/p\x3e \x3c/div\x3e";return{subject:b,messagePlain160:b.substring(0,160),messagePlain140:b.substring(0,140),messageHTML:e,messagePlain:b,url:c}};this.getDomElements=function(b,c){a.dom.$wrapper=a.vars.$("#"+b+" #"+c);a.dom.$lbContainer=a.dom.$wrapper.find(".vse-lb-container");a.dom.$lbLeftColumn=
a.dom.$wrapper.find(".vse-lb-left");a.dom.$lbRightColumn=a.dom.$wrapper.find(".vse-lb-right");a.dom.$lbCCHeader=a.dom.$wrapper.find(".vse-cc-header");a.dom.$lbTabContainer=a.dom.$wrapper.find(".vse-lightbox-tab");a.dom.$videoAuthor=a.dom.$wrapper.find(".vse-video-author span");a.dom.$mobileFixedContainer=a.dom.$wrapper.find(".vse-common-mobile-fixed-container");a.dom.$mobileMovableContainer=a.dom.$wrapper.find(".vse-vb-movable-container");a.dom.$relatedProductContainer=a.dom.$wrapper.find(".vse-related-products-narrow");
a.dom.$activeVideoOspLink=a.dom.$wrapper.find(".vse-oap-link");a.dom.$activeVideoTitlePrefix=a.dom.$wrapper.find(".vse-title-prefix");a.dom.$activeVideoCRLink=a.dom.$wrapper.find(".vse-cr-link");a.dom.$activeVideoCRLinkWrapper=a.dom.$wrapper.find(".video-title-container-right")};this.getCustomerProfileDomElements=function(){a.dom.$lbVideoCarousel=a.vars.isVideoImmersivePlayer?a.dom.$wrapper.find(".vse-vip-lb-carousel"):a.dom.$wrapper.find(".vse-related-videos-container");a.dom.$activeVideoCustomerProfile=
a.dom.$wrapper.find("#vse-active-video-customer-profile");a.dom.$videoAuthorBlock=a.dom.$wrapper.find(".vse-video-author");a.dom.$customerProfileContainer=a.dom.$wrapper.find(".vse-cp-container");a.dom.$profileLinkSelector=a.dom.$wrapper.find(".vse-profile")};this.shouldSetProductCarouselWidth=function(b){var c=a.dom.$wrapper.find(".vse-lb-right .vse-related-videos-container .a-carousel-row").height();return a.vars.A.isFiniteNumber(c)?c<b?!0:!1:!1};this.resizeDesktopLB=function(){var b=a.dom.$lbLeftColumn.outerHeight(!0);
if(!a.isDesktopVerticalLightBox()){var c=h.innerHeight-a.dom.$wrapper.closest(".vse-lightbox-wrapper").outerHeight();0<c&&a.dom.$wrapper.closest(".vse-lightbox-wrapper").animate({marginTop:c/2+"px",marginBottom:c/2+"px",top:0},0)}a.shouldSetProductCarouselWidth(b-a.vars.relatedProductsContainerFixedHeight)?(a.vars.$(e.RELATED_PRODUCTS_CONTAINER_SELECTOR).width(a.dom.$lbContainer.outerWidth()),a.dom.$lbRightColumn.css({"max-height":b-a.vars.relatedProductsContainerFixedHeight})):(a.vars.$(e.RELATED_PRODUCTS_CONTAINER_SELECTOR).removeAttr("style"),
a.dom.$lbRightColumn.css({"max-height":b}))};this.resizeMobileLB=function(){a.dom.$lbContainer.height(h.innerHeight);var b=a.vars.$(a.dom.$mobileFixedContainer).outerHeight(!0),b=a.vars.$(h).height()-b;a.vars.$(a.dom.$mobileMovableContainer).animate({"max-height":b})};this.resizeLB=function(){a.vars.isMobile?a.resizeMobileLB():a.resizeDesktopLB()};this.isOspEnabled=function(b){return!a.vars.A.objectIsEmpty(b.vendorTrackingId)&&""!==b.vendorTrackingId};this.showVideoImmersivePlayerOverlay=function(){a.dom.$wrapper.find(e.VIPOverlaySelector).addClass(e.VIPOverlayShowClassName)};
this.hideVideoImmersivePlayerOverlay=function(){a.dom.$wrapper.find(e.VIPOverlaySelector).removeClass(e.VIPOverlayShowClassName)};this.setUserActivityTimer=function(b){a.vars.$(b.target).hasClass(e.VIPOverlayShowClassName)||a.vars.$(b.target).hasClass(e.UpNextClassName)||a.vars.$(b.target).hasClass(e.VIPMetadataClassName)||a.vars.$(b.target).hasClass(e.VIPVideoInfoClassName)||a.vars.$(b.target).hasClass(e.VIPVideoTitleWrapperClassName)||a.vars.$(b.target).hasClass(e.VIPVideoHelpfulVotesClassName)||
a.vars.$(b.target).hasClass(e.VIPPlayPauseClassName)||a.vars.$(b.target).hasClass(e.VIPScrubberClassName)?a.hideVideoImmersivePlayerOverlay():a.resetUserActivityTimer()};this.resetUserActivityTimer=function(b){void 0===b&&(b=0);a.vars.secondsFromLastActivity=b};this.userActivityCountDown=function(){a.vars.intervalUserActivityHandlerId=a.vars.A.interval(function(){a.vars.secondsFromLastActivity++;3<a.vars.secondsFromLastActivity&&a.hideVideoImmersivePlayerOverlay()},1E3);if(a.vars.isVIPOverlayTimerSet)return a.vars.intervalUserActivityHandlerId;
var b="mousedown mousemove keydown touchmove scroll touchstart".split(" ");a.vars.$(""+a.vars.popoverId)&&(b.forEach(function(b){a.dom.$lbContainer.click(function(b){a.setUserActivityTimer(b)})}),a.vars.isVIPOverlayTimerSet=!0);return a.vars.intervalUserActivityHandlerId};this.clearIntervalUserActivityHandler=function(){a.vars.isVIPOverlayTimerSet=!1;clearInterval(a.vars.intervalUserActivityHandlerId)};this.emitMetric=function(b){a.vars.emitSushiMetric&&(b=a.vars.buildSushiPayload({eventName:b,stringPayload:e.EMPTY_STRING,
intPayload:1}),l.emitSushiMetric(b,a.vars.universalSushiEndpoint))};this.emitClickMetric=function(b){a.vars.emitSushiMetric&&!a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)&&(b=a.vars.buildSushiPayload({eventName:b,stringPayload:e.EMPTY_STRING,intPayload:1,videoAsin:a.vars.currentAssetSpec.contentId?a.vars.currentAssetSpec.contentId:a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).contentId,groupType:a.vars.currentAssetSpec.groupType?a.vars.currentAssetSpec.groupType:a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).groupType}),
l.emitSushiMetric(b,a.vars.universalSushiEndpoint))};this.emitRelatedVideosRenderMetric=function(b){a.vars.emitSushiMetric&&!a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)&&(b=a.vars.buildSushiPayload({eventName:b,stringPayload:e.EMPTY_STRING,intPayload:1,videoAsinList:a.vars.relatedVideosCarousel.getplaylist().map(function(a){return a.contentId+e.COMMA+a.groupType}).join(e.SEMICOLON)}),l.emitSushiMetric(b,a.vars.universalSushiEndpoint))};this.emitPFOClickMetric=function(b,c,h){a.vars.emitSushiMetric&&
(b=a.vars.buildSushiPayload({eventName:b,stringPayload:e.EMPTY_STRING,intPayload:1,productAsin:c,isSponsored:h,videoAsin:a.vars.currentAssetSpec.contentId?a.vars.currentAssetSpec.contentId:a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).contentId,groupType:a.vars.currentAssetSpec.groupType?a.vars.currentAssetSpec.groupType:a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).groupType}),l.emitSushiMetric(b,a.vars.universalSushiEndpoint))};this.emitPFORenderMetric=function(b){if(a.vars.emitSushiMetric){for(var c=
a.A.$("#"+a.vars.templateId+" .vse-pc-visible").not(".aok-hidden").find(".vse-product-item"),h="",g=0;g<c.length;g++)a.vars.productElements.push([c[g].getAttribute("data-asin"),c[g].classList.contains("vse-sponsor-product").toString(),!1]),h+=c[g].getAttribute("data-asin")+","+c[g].classList.contains("vse-sponsor-product").toString(),g!==c.length-1&&(h+=e.SEMICOLON);b=a.vars.buildSushiPayload({eventName:b,stringPayload:e.EMPTY_STRING,intPayload:1,productAsinList:h,videoAsin:a.getVideoAsin(),groupType:a.getGroupType()});
l.emitSushiMetric(b,a.vars.universalSushiEndpoint)}};this.getVideoAsin=function(){return a.vars.currentAssetSpec.contentId?a.vars.currentAssetSpec.contentId:a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)?e.EMPTY_STRING:a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).contentId};this.getGroupType=function(){return a.vars.currentAssetSpec.groupType?a.vars.currentAssetSpec.groupType:a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)?e.EMPTY_STRING:a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).groupType};
this.emitPFOImpressionMetric=function(b,c,h){a.vars.emitSushiMetric&&(b=a.vars.buildSushiPayload({eventName:b,stringPayload:e.EMPTY_STRING,intPayload:1,productAsin:c,isSponsored:h,videoAsin:a.vars.currentAssetSpec.contentId?a.vars.currentAssetSpec.contentId:a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).contentId,groupType:a.vars.currentAssetSpec.groupType?a.vars.currentAssetSpec.groupType:a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).groupType}),l.emitSushiMetric(b,a.vars.universalSushiEndpoint))};
this.emitVIPThumbnailImpressionMetric=function(b,c){a.vars.emitSushiMetric&&(b=a.vars.buildSushiPayload({eventName:b,stringPayload:e.EMPTY_STRING,intPayload:1,videoAsin:c.contentId,groupType:c.groupType}),l.emitSushiMetric(b,a.vars.universalSushiEndpoint))};this.emitVIPThumbnailImpressionMetricHandler=function(){for(var b=h.innerWidth>h.innerHeight?Math.floor((h.innerHeight+a.A.$("#"+a.vars.templateId+" "+e.VIPLbCarouselViewportSelector).scrollTop())/a.A.$("#"+a.vars.templateId+" .vse-video-card").first().height()):
Math.floor((h.innerWidth+a.A.$("#"+a.vars.templateId+" "+e.VIPLbCarouselViewportSelector).scrollLeft())/a.A.$("#"+a.vars.templateId+" .vse-video-card").first().width()),c=0;c<Math.min(b,a.vars.playlist.length);c++)a.vars.playlist[c].impressionRecorded||(a.emitVIPThumbnailImpressionMetric(e.METRIC_WATCH_THUMBNAIL_IMPRESSION,a.vars.playlist[c]),a.vars.playlist[c].impressionRecorded=!0)};this.emitPFOImpressionMetricHandler=function(){for(var b=h.innerWidth>h.innerHeight?Math.floor((a.A.$("#"+a.vars.templateId+
" "+e.VIPProductCarouselViewportSelector).scrollTop()+h.innerHeight)/a.A.$("#"+a.vars.templateId+" .vse-product-item").first().height()):Math.floor((a.A.$("#"+a.vars.templateId+" "+e.VIPProductCarouselViewportSelector).scrollLeft()+h.innerWidth)/a.A.$("#"+a.vars.templateId+" .vse-product-item").first().width()),c=0;c<Math.min(b,a.vars.productElements.length);c++)a.vars.productElements[c][2]||(a.emitPFOImpressionMetric(e.METRIC_PFO_IMPRESSION,a.vars.productElements[c][0],a.vars.productElements[c][1]),
a.vars.productElements[c][2]=!0)};this.handleWatchIconMetric=function(){var b=function(b){a.emitClickMetric(e.METRIC_WATCH_ICON)};a.A.$("#"+a.vars.templateId+" "+e.VIPLbCarouselViewportSelector).unbind("scroll");a.A.$("#"+a.vars.templateId+" "+e.VIPLbCarouselViewportSelector).bind("scroll",a.emitVIPThumbnailImpressionMetricHandler);a.A.$("#"+a.vars.templateId+" "+e.VIPWatchIconSelector+".vse-unpressed").click(b);a.A.$("#"+a.vars.templateId+" "+e.VIPWatchIconSelector+".vse-pressed").click(b)};this.handleShopIconMetric=
function(){var b=function(b){a.emitClickMetric(e.METRIC_SHOP_ICON)};a.A.$("#"+a.vars.templateId+" "+e.VIPShopIconSelector+".vse-unpressed").click(b);a.A.$("#"+a.vars.templateId+" "+e.VIPShopIconSelector+".vse-pressed").click(b)};this.handleShareIconMetric=function(){a.A.on("a:sheet:beforeShow:"+a.vars.socialShareId+"-sheet",function(){a.emitClickMetric(e.METRIC_SHARE_ICON)})};this.handleInfluencerProfileNameClick=function(b){a.dom.$activeVideoCustomerProfile.find(".a-profile-name").unbind("click");
a.dom.$activeVideoCustomerProfile.find(".a-profile-name").click(function(b){l.count(a.vars.clientPrefix+".influencerProfileNameClickCount",1)})};this.getDeviceOrientation=function(){return h.innerHeight>h.innerWidth?e.PORTRAIT:h.innerWidth>h.innerHeight?e.LANDSCAPE:e.SQUARE};this.getAspectRatio=function(a){if(a===e.PORTRAIT)return e.PORTRAIT_ASPECT_RATIO;if(a===e.LANDSCAPE)return e.LANDSCAPE_ASPECT_RATIO;if(a===e.SQUARE)return e.SQUARE_ASPECT_RATIO};this.isDesktopVerticalLightBox=function(){return!a.vars.isMobile&&
h.innerWidth<a.vars.verticalLightBoxMaxWidth};this.attachStickyHeaders=function(){a.vars.isMobile||!a.vars.lightboxOpened||a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.vars.relatedVideosCarousel.attachStickyHeader({A:a.vars.A,stickyHeaderContainer:"#"+a.vars.popoverId+" .vse-lb-right",stickyHeaderLBContainer:"#"+a.vars.popoverId,lbModalContainer:".a-modal-scroller.a-declarative"})};this.resetStickyHeaders=function(){a.vars.isMobile||a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||
a.dom.$lbRightColumn.find(".vse-vc-header.first-item").removeAttr("style").removeClass("vse-absolute")};this.initializeVideoActionTray=function(b,c){a.vars.videoActionTrayComponents=new ca({A:a.A,contentCarousel:a.vars.relatedVideosCarousel,socialShareId:a.vars.socialShareId,templateId:a.vars.templateId});a.setVIPOrientationProperties(c);a.handleShopIconMetric();a.vars.videoActionTrayComponents.handleShopIconInteractions();a.vars.videoActionTrayComponents.handleShareIconInteractions();a.handleShareIconMetric();
a.handleWatchIconMetric();a.vars.videoActionTrayComponents.handleVIPCarouselClose();a.initializeWatchComponents(b);a.A.on("vse:"+a.vars.templateId+":vip:vat:component:open",function(){a.A.$("#"+a.vars.templateId+" "+e.VIPActionOverlaySelector).addClass(e.VIPActionOverlayShowClassName)});a.A.on("vse:"+a.vars.templateId+":vip:vat:component:close",function(){a.A.$("#"+a.vars.templateId+" "+e.VIPActionOverlaySelector).removeClass(e.VIPActionOverlayShowClassName)})};this.initializeVIPControls=function(){var b=
a.dom.$wrapper.find(e.VIPSkipBackButtonSelector);b.unbind("click");b.click(function(b){b.stopPropagation();b=a.vars.player.getCurrentTime();a.vars.player.setCurrentTime(b-10);a.resetUserActivityTimer(2);a.vars.isContinuousPlayFinished=!1;a.emitClickMetric(e.METRIC_SKIP_BACK)});b=a.dom.$wrapper.find(e.VIPSkipForwardButtonSelector);b.unbind("click");b.click(function(b){b.stopPropagation();b=a.vars.player.getCurrentTime();a.vars.player.setCurrentTime(b+15);a.resetUserActivityTimer(2);a.emitClickMetric(e.METRIC_SKIP_FORWARD)});
a.vars.vipPlayPauseToggle=a.dom.$wrapper.find(e.VIPPlayPauseToggleSelector);a.vars.vipPlayPauseToggle.unbind("click");a.vars.vipPlayPauseToggle.click(function(b){b.stopPropagation();a.vars.vipControlsShouldPause?(a.pauseVideoIfNeeded(),a.vars.vipControlsShouldPause=!1,a.emitClickMetric(e.METRIC_PAUSE)):(a.vars.useUpNextComponent&&a.vars.isUpNextComponentActive?a._playUpNextHandler():a.resumeVideoIfNeeded(),a.resetUserActivityTimer(2),a.vars.vipControlsShouldPause=!0,a.emitClickMetric(e.METRIC_PLAY));
a.vars.vipPlayPauseToggle.toggleClass(e.VIPPauseIconClassName,a.vars.vipControlsShouldPause);a.vars.vipPlayPauseToggle.toggleClass(e.VIPPlayIconClassName,!a.vars.vipControlsShouldPause)});var c=a.dom.$wrapper.find(e.VIPProgressBarFillSelector),h=a.dom.$wrapper.find(e.VIPProgressBarSelector),g=a.dom.$wrapper.find(e.VIPTimeElapsedSelector),k=a.dom.$wrapper.find(e.VIPTimeRemainingSelector);a.vars.player.on("timeupdate",function(){if(0===a.vars.vipVideoDuration)a.vars.vipVideoDuration=a.vars.player.getMediaDuration();
else{var b=a.vars.player.getCurrentTime(),d=b/a.vars.vipVideoDuration,d=h.width()*d;c.width(d);var d=Math.floor(b%60),f=Math.floor(b/60%60),e=0,l=!1;3600<=a.vars.vipVideoDuration&&(e=Math.floor(b/3600),l=!0);g.text((l?e+":":"")+(l&&10>f?"0"+f+":":f+":")+(10>d?"0"+d:d));b=a.vars.vipVideoDuration-b;d=Math.floor(b%60);f=Math.floor(b/60%60);l&&(e=Math.floor(b/3600));k.text("-"+(l?e+":":"")+(l&&10>f?"0"+f+":":f+":")+(10>d?"0"+d:d))}});a.dom.$wrapper.delegate(e.VIPProgressBarSelector,"touchstart",function(b){b.stopPropagation();
a.vars.isScrubbing=!0;a.pauseVideoIfNeeded()});a.dom.$wrapper.delegate(e.VIPProgressBarSelector,"touchmove",function(b){if(a.vars.isScrubbing){b.stopPropagation();a.resetUserActivityTimer();var c=h.offset().left,f=h.width();b=Math.max(0,Math.min(1,(b.originalEvent.touches[0].pageX-c)/f));c=a.vars.vipVideoDuration*b;1===b&&(c-=.1);a.vars.player.setCurrentTime(c)}});a.dom.$wrapper.delegate(e.VIPProgressBarSelector,"touchend",function(b){b.stopPropagation();a.vars.isScrubbing=!1;a.resumeVideoIfNeeded()});
a.dom.$wrapper.delegate(e.VIPProgressBarSelector,"click",function(b){b.stopPropagation();a.resetUserActivityTimer();var c=h.offset().left,f=h.width();a.vars.player.setCurrentTime(a.vars.vipVideoDuration*Math.max(0,Math.min(1,(b.pageX-c)/f)))})};this.updateSegmentTab=function(b){a.vars.relatedVideosCarousel&&a.vars.relatedVideosCarousel.updateSegmentTabForActiveVideo(b)};this.emitWidgetClickMetric=function(){var b=a.vars.buildSushiPayload({eventName:a.vars.clientPrefix+".widgetClick",stringPayload:e.EMPTY_STRING,
intPayload:1});l.emitSushiMetric(b,a.vars.universalSushiEndpoint)};this.emitThumbnailMetric=function(b,c){b=a.vars.buildSushiPayload({eventName:b,stringPayload:e.EMPTY_STRING,intPayload:c,videoAsin:a.vars.ingressPlaylist[c].contentId});l.emitSushiMetric(b,a.vars.universalSushiEndpoint)};this.emitThumbnailRenderMetric=function(b,c){b=a.vars.buildSushiPayload({eventName:b,stringPayload:e.EMPTY_STRING,intPayload:c,videoAsinList:a.vars.ingressPlaylist.map(function(a){return a.contentId}).join(",")});
l.emitSushiMetric(b,a.vars.universalSushiEndpoint)};this.emitThumbnailMetricOnResize=function(){for(var b=a.vars.carouselPageSize;b<Math.min(a.vars.ingressCarousel.auiCarousel.getAttr("pageSize"),a.vars.ingressPlaylist.length);b++)a.emitThumbnailMetric(a.vars.clientPrefix+".thumbnailImpression",b);a.vars.carouselPageSize=a.vars.ingressCarousel.auiCarousel.getAttr("pageSize");a.vars.previousPage=a.vars.ingressCarousel.auiCarousel.getAttr("totalPages");a.vars.carouselPageSize>=a.vars.ingressPlaylist.length&&
(a.vars.A.off("a:carousel:"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+":change:pageSize",a.emitThumbnailMetricOnResize),a.vars.A.off("a:carousel:"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+":change:pageNumber",a.emitThumbnailMetricOnNextPage))};this.emitThumbnailMetricOnNextPage=function(){var b=a.vars.ingressCarousel.auiCarousel.getAttr("pageNumber"),c=a.vars.carouselPageSize*(b-1),e=Math.min(c+a.vars.carouselPageSize,a.vars.ingressPlaylist.length);1<b&&a.vars.A.off("a:carousel:"+
a.vars.ingressCarousel.contentCarouselConfig.carouselName+":change:pageSize",a.emitThumbnailMetricOnResize);if(b===a.vars.nextPage){for(b=c;b<e;b++)a.emitThumbnailMetric(a.vars.clientPrefix+".thumbnailImpression",b);a.vars.nextPage++;e!==a.vars.ingressPlaylist.length&&a.vars.nextPage!==a.vars.previousPage+1||a.vars.A.off("a:carousel:"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+":change:pageNumber",a.emitThumbnailMetricOnNextPage)}else if(b===a.vars.previousPage){for(b=c;b<e;b++)a.emitThumbnailMetric(a.vars.clientPrefix+
".thumbnailImpression",b);a.vars.previousPage--}};this.vseCsmWidgetLoadedMetrics=function(){var b=a.vars.A.$("#"+a.vars.clientPrefix+"-vse-related-videos");if(a.vars.isMetricRecorded||a.vars.A.objectIsEmpty(b.offset()))a.vars.A.off("scroll",a.vseCsmWidgetLoadedMetrics);else if(a.vars.A.onScreen(b)){b=a.vars.A.now()-a.vars.widgetStartTime;a.vars.A.$("#vse-spinner").hasClass("aok-hidden")?(l.count(a.vars.clientPrefix+".widgetViewedAndLoadedCount",1),l.count(a.vars.clientPrefix+".widgetViewedAndLoadedDuration",
b)):(l.count(a.vars.clientPrefix+".widgetViewedNotLoadedCount",1),l.count(a.vars.clientPrefix+".widgetViewedNotLoadedDuration",b));l.count(a.vars.clientPrefix+".pageLoadToWidgetViewedDuration",b);if(a.vars.emitSushiMetric){b=a.vars.buildSushiPayload({eventName:a.vars.clientPrefix+".pageView",stringPayload:e.EMPTY_STRING,intPayload:1});l.emitSushiMetric(b,a.vars.universalSushiEndpoint);a.vars.carouselPageSize=Math.min(a.vars.ingressCarousel.carouselPageSize,a.vars.ingressPlaylist.length);a.vars.nextPage=
a.vars.ingressCarousel.carouselPageNumber+1;a.vars.previousPage=a.vars.ingressCarousel.auiCarousel.getAttr("totalPages");for(b=0;b<a.vars.carouselPageSize;b++)a.emitThumbnailMetric(a.vars.clientPrefix+".thumbnailImpression",b);a.vars.carouselPageSize!=a.vars.ingressPlaylist.length&&(a.vars.A.on("a:carousel:"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+":change:pageSize",a.emitThumbnailMetricOnResize),a.vars.A.on("a:carousel:"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+
":change:pageNumber",a.emitThumbnailMetricOnNextPage))}a.vars.isMetricRecorded=!0}};this.getModalFactory=function(){var b=null;a.vars.isMobile?q.now("a-secondary-view").execute("vw-dp-secondary-view",function(a){b=a}):q.now("a-modal").execute("vw-dp-modal",function(a){b=a});return b};this.resetVIPControls=function(){a.vars.vipControlsShouldPause||(a.vars.vipControlsShouldPause=!0,a.vars.vipPlayPauseToggle.toggleClass(e.VIPPlayIconClassName,!a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(e.VIPPauseIconClassName,
a.vars.vipControlsShouldPause))};this.requestMshopFullscreen=function(){a.vars.A.objectIsEmpty(a.vars.mShopFactory)||a.vars.mShopFactory.requestFullscreen({successCallback:function(){document.addEventListener("touchmove",a.mShopScrollLock,!0);document.addEventListener("touch",a.mShopScrollLock,!0);a.vars.A.delay(function(){a.vars.A.trigger("resize",{},{width:h.innerWidth,height:document.documentElement.clientHeight});a.dom.$lbContainer&&a.dom.$lbContainer.height(document.documentElement.clientHeight)},
200)},failCallback:function(){a.vars.A.trigger("resize",{},{width:h.innerWidth,height:document.documentElement.clientHeight});a.dom.$lbContainer&&a.dom.$lbContainer.height(document.documentElement.clientHeight)}})};this.cancelMshopFullscreen=function(b){void 0===b&&(b=function(){});a.vars.A.objectIsEmpty(a.vars.mShopFactory)||a.vars.mShopFactory.cancelFullscreen({successCallback:function(){document.removeEventListener("touchmove",a.mShopScrollLock,!0);document.removeEventListener("touch",a.mShopScrollLock,
!0);b()},failCallback:function(){a.requestMshopFullscreen()}})};this.cancelMshopFullscreenAndNavigate=function(b){"string"===typeof b?a.cancelMshopFullscreen(function(){a.vars.A.delay(function(){a.vars.$(".vse-close-button").click();h.location.href=b},600)}):(b.preventDefault(),a.cancelMshopFullscreen(function(){if(b.srcElement){var c=b.srcElement.getAttribute("href");a.vars.$(".vse-close-button").click();h.location.href=c}}))};this.openExternalLinkFromLightBox=function(b){a.pauseVideoIfNeeded();
a.vars.isMshop&&a.vars.isVideoImmersivePlayer&&a.cancelMshopFullscreenAndNavigate(b)};this.mShopScrollLock=function(b){0<a.vars.$(b.target).closest(e.VIPActionOverlaySelector).length||0<a.vars.$(b.target).closest(".vse-profile").length||0<a.vars.$(b.target).closest(".vse-fb-sheet").length||a.vars.$(b.target).hasClass("vse-fb-copyright")||a.vars.$(b.target).hasClass("vse-oap-link")||a.vars.$(b.target).hasClass("vse-profile")||a.vars.$(b.target).hasClass("vse-cr-link")?b.stopPropagation():b.preventDefault()};
this.initializeWatchComponents=function(b){a.vars.relatedVideosCarousel.initializeSegmentTabs({A:a.A,segmentTabs:b,segmentTabCssClassSelectorName:"#"+a.vars.popoverId+" "+e.VIPLbTabsContainerSelector+" .vse-vip-lb-tab"});a.vars.videoActionTrayComponents.handleWatchIconInteractions()};this.setVIPOrientationProperties=function(b){var c={carouselAnimationType:{width:"toggle"},getCardInViewOffset:function(a){return a.offset().left},getOffsetPointForTabUpdate:function(){return h.innerWidth/2},animatedCarouselDimensionValue:function(){return b},
getCarouselPropertyToAnimate:function(a){return{scrollLeft:a}}},k={carouselAnimationType:{height:"toggle"},getCardInViewOffset:function(a){return a.offset().top},getOffsetPointForTabUpdate:function(){return a.A.$("#"+a.vars.templateId+" "+e.VIPLbTabsContainerSelector).outerHeight(!0)+parseInt(a.A.$("#"+a.vars.templateId+" "+e.VIPLbCarouselSelector+" .vse-video-card:first").css("margin-top"))},animatedCarouselDimensionValue:function(){return a.A.$("#"+a.vars.templateId+" "+e.VIPLbCarouselSelector+
" .vse-video-card:last").outerHeight(!0)+3},getCarouselPropertyToAnimate:function(a){return{scrollTop:a}}};h.innerHeight>h.innerWidth&&a.setOrintationConfig(c);h.innerWidth>h.innerHeight&&(a.setOrintationConfig(k),a.updateLbViewportHeight());a.A.on.orientationchange(function(b){0===b.orientation?(a.setOrintationConfig(c),a.resetLbViewportHeight()):(a.setOrintationConfig(k),a.updateLbViewportHeight())})};this.setOrintationConfig=function(b){a.vars.videoActionTrayComponents.setOrientationConfig(b);
a.vars.relatedVideosCarousel.setOrientationConfig(b)};this.resetLbViewportHeight=function(){a.A.$("#"+a.vars.templateId+" "+e.VIPLbCarouselViewportSelector).css("height","initial")};this.updateLbViewportHeight=function(){a.A.$("#"+a.vars.templateId+" "+e.VIPLbCarouselViewportSelector).height(h.innerHeight-a.A.$("#"+a.vars.templateId+" "+e.VIPLbTabsContainerSelector).outerHeight(!0))};this.vars={A:b,$:b.$,isMobile:!1,player:null,feedback:null,clientPrefix:null,placement:null,containerId:null,contentId:null,
productAsin:null,playerFactory:null,ingressRelatedVideosCarousel:null,relatedVideosCarousel:null,videoVoteContainerFactory:null,activeVideoVoteContainer:null,isMshop:!1,isContinuousPlayFinished:!1,isFeedbackClosed:!0,showVotes:!1,videoVoteFailure:!1,videoVoteConfig:null,currentAssetSpec:null,initialVideo:null,relatedProductsNilgiriRequestCount:0,popoverId:null,relatedProductsRequest:null,cursorOnVideoPlayerDiv:!1,lightBoxPausedVideo:!1,verticalLightBoxMaxWidth:1024,relatedProductsContainerFixedHeight:115,
currentIndex:0,socialSharePageState:null,buildSushiPayload:null,mShopFactory:null,lightboxOpened:!1,lightboxCarouselRegistered:!1,playFullScreenVideo:!1,ingressHasInitialAssetSpec:!0,playlist:null,isVideoImmersivePlayer:!1,secondsFromLastActivity:0,intervalUserActivityHandlerId:0,isVIPOverlayTimerSet:!1,lightboxOpenedFirstTime:!0,videoActionTrayComponents:null,socialShareId:null,ingressCarousel:null,ingressPlaylist:null,sushiMetricsConfig:null,universalSushiEndpoint:e.EMPTY_STRING,widgetStartTime:0,
isMetricRecorded:!1,carouselPageSize:0,nextPage:0,previousPage:0,emitSushiMetric:!1,vipVideoDuration:0,isScrubbing:!1,vipControlsShouldPause:!0,vipPlayPauseToggle:null,shouldShowProfiles:!1,popoverName:null,isUpNextComponentActive:!1,upNextTimeoutHandle:null,useUpNextComponent:!1,upNextString:e.EMPTY_STRING,cancelString:e.EMPTY_STRING,watchIconFirstOpen:!0,shopIconFirstOpen:!0,productElements:[],showClosedCaptions:!1};this.dom={$wrapper:null,$lbContainer:null,$lbLeftColumn:null,$lbRightColumn:null,
$lbCCHeader:null,$lbTabContainer:null,$videoAuthor:null,$playerContainer:null,$mobileFixedContainer:null,$mobileMovableContainer:null,$relatedProductContainer:null,$activeVideoOspLink:null,$activeVideoTitlePrefix:null,$activeVideoCRLink:null,$lbVideoCarousel:null,$activeVideoCustomerProfile:null,$customerProfileContainer:null,$videoAuthorBlock:null,$activeVideoCRLinkWrapper:null,$profileLinkSelector:null}}c.prototype.isCustomerReviewVideo=function(b){return"AOD60"==b.vendorCode};c.prototype.isInfluencerVideo=
function(b){return 0<(this.dom.$lbVideoCarousel?this.dom.$lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]').find(".vse-video-influencer-profile"):"").length?b.creatorType?"influencer"===b.creatorType.toLowerCase():!1:!1};return c}(),w=function(){function c(){}c.ELM_OTHER_OPTION=".vse-fb-other";c.ELM_RBTN_CHECKED='input[name\x3d"FeedbackInput"]:checked';c.ELM_CHECKBOX_CHECKED='input[type\x3d"checkbox"]:checked';c.DATA_REQ_MSG="requiredcommentmessage";c.DATA_OPTIONAL_MSG="optionalcommentmessage";
c.ATTR_NAME_PLACEHOLDER="placeholder";return c}(),S=n,T=n;q.when("a-sheet").execute(function(c){S=c});q.when("a-popover").execute(function(c){T=c});var U={getBottomSheet:function(){return S},getPopoverFactory:function(){return T}},da=function(){function c(b){var a=this;this.config=b;this.activeVideoSource=this.activeVideo="VIDEO_NOT_SELECTED";this.isOtherSelected=this.registered=!1;this.setBottomSheetHeight=!0;this.internalRejectedVideo=!1;this.defaultBottomSheetHeight=400;this._submitErrorCallback=
function(b){a.A.trigger("vse:"+a.id+":feedback:submitted:error")};this._submitSuccessCallback=function(b){a.A.trigger("vse:"+a.id+":feedback:submitted:success")};this.A=b.A;this.pageStateName=b.pageStateName;this.buttonApi=b.buttonApi;this.id=this.config.id;b=v.fetchLatestPageState(this.A,this.pageStateName);this.feedbackSection=this.A.$("#"+this.id);this.feedbackForm=this.A.$("#"+this.id+"-form");this.commentBox=this.A.$("#"+this.id+"-comment-box");this.requiredCommentMessage=this.commentBox.parent().data(w.DATA_REQ_MSG);
this.optionalCommentMessage=this.commentBox.parent().data(w.DATA_OPTIONAL_MSG);this.thankYouSection=this.A.$("#"+this.id+"-ty-container");this.submitButton=this.buttonApi("#"+this.id+"-btn-submit");this.cancelButton=this.A.$("#"+this.id+"-btn-cancel");b&&this.validateFormElements()&&(this.isMobile=b.isMobile,this.endpoint=b.feedbackEndpoint,this.isInternal=b.isInternal,this.marketplaceId=b.marketplaceId,this.pageAsin=b.pageAsin,this.customerId=b.customerId,this.bottomSheetFactory=U.getBottomSheet(),
this.popoverFactory=U.getPopoverFactory(),this.registered||(this.A.declarative(this.id+"-options-choose","click",function(b){a.activeSelectionEvent=b;a.A.$(b)&&a.A.$(b.$target)&&(a.currentViolations=a.A.$(b.$target).closest(".vse-fb-option").find("input").val());a.otherSection=b.$target.closest(w.ELM_OTHER_OPTION);1===a.otherSection.length?(a.updatePlaceholderString(a.requiredCommentMessage),a.isOtherSelected=!0):(a.isOtherSelected=!1,a.updatePlaceholderString(a.optionalCommentMessage));a.submitButton.enable()}),
this.A.declarative(this.id+"-andoncord-check","change",function(b){a.internalRejectedVideo=b.$target.is(":checked")}),this.A.declarative(this.id+"-btn-close","click",function(){return a.closeFeedbackForm()}),this.A.declarative(this.id+"-btn-cancel","click",function(){return a.cancelFeedbackForm()}),this.A.declarative(this.id+"-btn-submit","click",function(){return a.submitFeedback()}),this.A.on("a:sheet:afterShow:"+this.id+"-sheet",function(b){a.defaultBottomSheetHeight=.75*a.A.$(h).height();a.changeBottomSheetHeight(b,
a.defaultBottomSheetHeight);a.showFeedbackForm()}),this.A.on("a:sheet:afterHide:"+this.id+"-sheet",function(b){a.resetFeedbackForm().hideThankYou();a.A.trigger("vse:"+a.id+":feedback:hidden")}),this.A.on("a:popover:afterShow:"+this.id+"-popover",function(b){a.showFeedbackForm()}),this.A.on("a:popover:afterHide:"+this.id+"-popover",function(b){a.hideFeedbackForm()}),this.registered=!0))}c.prototype.showFeedbackForm=function(b){this.A.trigger("vse:"+this.id+":feedback:shown");return this};c.prototype.hideFeedbackForm=
function(){this.isMobile?this.getAndSetBottomSheetInstance()&&this.bottomSheetInstance.hide():this.getAndSetPopoverInstance()&&this.popoverInstance.hide();this.resetFeedbackForm().hideThankYou();this.A.trigger("vse:"+this.id+":feedback:hidden");return this};c.prototype.setActiveVideoAndSource=function(b,a){this.activeVideo=b;this.activeVideoSource=a};c.prototype.submitFeedback=function(){if(this.currentViolations)if(this.isOtherSelected&&this.commentBox&&""===this.commentBox.val())this.commentBox.focus();
else{var b={events:[{data:{feedback:{additionalComments:this.commentBox?this.commentBox.val():"",playerVersion:"",asin:this.pageAsin,videoId:this.activeVideo,videoSource:this.activeVideoSource,violations:this.currentViolations,url:document.location.href,userAgent:h.navigator&&h.navigator.userAgent?h.navigator.userAgent:"window.navigator.userAgent not supported",feedbackTime:this.A.now(),customerId:this.customerId,isInternal:this.isInternal,feedbackWidgetVersion:"2",marketplace:this.marketplaceId,
internalRejectedVideo:this.internalRejectedVideo,placement:this.pageStateName}}}]};this.A.$.ajax({url:this.endpoint,data:JSON.stringify(b),type:"POST",contentType:"application/json; charset\x3dutf-8",error:this._submitErrorCallback,success:this._submitSuccessCallback});this.A.trigger("vse:"+this.id+":feedback:submitted");this.resetFeedbackForm().showThankYou()}else this.resetFeedbackForm()};c.prototype.cancelFeedbackForm=function(){this.resetFeedbackForm();this.A.trigger("vse:"+this.id+":feedback:cancelled")};
c.prototype.closeFeedbackForm=function(){this.hideFeedbackForm();this.A.trigger("vse:"+this.id+":feedback:closed")};c.prototype.resetFeedbackForm=function(){this.submitButton.disable();this.feedbackSection.find(w.ELM_RBTN_CHECKED).each(function(){this.checked=!1});this.updatePlaceholderString(this.optionalCommentMessage);this.commentBox.val("");this.internalRejectedVideo=!1;this.feedbackSection.find(w.ELM_CHECKBOX_CHECKED).each(function(){this.checked=!1});return this};c.prototype.showThankYou=function(){this.feedbackForm.fadeOut(200);
this.thankYouSection.addClass("show").removeClass("aok-hidden").fadeIn(400);this.A.trigger("vse:"+this.id+":thank-you:shown");return this};c.prototype.hideThankYou=function(){this.feedbackForm.fadeIn(10);this.thankYouSection.addClass("aok-hidden").removeClass("show").fadeOut(10);this.A.trigger("vse:"+this.id+":thank-you:hidden");return this};c.prototype.validateFormElements=function(){return this.feedbackSection.length&&this.commentBox.length&&this.thankYouSection.length&&this.submitButton.size()&&
this.cancelButton.length&&this.feedbackForm.length};c.prototype.updatePlaceholderString=function(b){this.commentBox.attr(w.ATTR_NAME_PLACEHOLDER,b)};c.prototype.changeBottomSheetHeight=function(b,a){this.setBottomSheetHeight&&(b.sheet.changeHeight({duration:.3,height:a}),this.setBottomSheetHeight=!1)};c.prototype.getAndSetBottomSheetInstance=function(){return this.bottomSheetFactory?this.bottomSheetInstance?this.bottomSheetInstance:this.bottomSheetInstance=this.bottomSheetFactory.get(this.id+"-sheet"):
n};c.prototype.getAndSetPopoverInstance=function(){return this.popoverFactory?this.popoverInstance?this.popoverInstance:this.popoverInstance=this.popoverFactory.get(this.id+"-popover"):n};return c}(),ea=function(){function c(b){this.config=b;this.feedbackWidgets={}}c.prototype.create=function(b,a){a=this.feedbackWidgets[b]||new da({id:b,pageStateName:a,A:this.config.A,buttonApi:this.config.buttonApi});return this.feedbackWidgets[b]=a};c.prototype.get=function(b){return this.feedbackWidgets[b]};return c}(),
fa=function(){function c(){}c.getLazyLoadComponents=function(b,a,e,h,k){b.$("#"+a+" div[data-configuration]").each(function(){c.callSubComponentBuilder({A:b,context:e,handleFailure:k,handleSuccess:h},b.$(this),3)})};c.callSubComponentBuilder=function(b,a,e){var h=b.A,k=b.context,g=b.handleFailure,q=b.handleSuccess,p=atob(a.attr("data-configuration")),d=JSON.parse(p),p=e,E={pageContext:k,configuration:d},B=h.now();e--;var x=p-e-1;y.sendRequest(h,"/vap/ew/subcomponent/"+d.type,E,function(b){var c=h.now()-
B;l.count("vse_component_lazyLoaderHook:success:",c);l.count("vse_component_lazyLoaderHook:success:"+k.page+":"+k.placement+":"+d.type+":"+x,1);a.html(b);q(h,E)},function(B){(0===B.http.status||500<=B.http.status&&599>=B.http.status)&&0<e?(l.count("vse_component_lazyLoaderHook:error:"+k.page+":"+k.placement+":"+d.type+":"+x,1),c.callSubComponentBuilder(b,a,e)):(l.count("vse_component_lazyLoaderHook:failure",1),g(h,E))})};return c}();try{var ga=function(c){return new c(function(b,a){q.when("A","a-carousel-framework",
"3p-promise","a-button","ready").register("VSEComponentAssets",function(a,c,p,g){return{setClientPrefix:function(b,n){var d=new R(a);d.vars.clientPrefix=b;d.vars.templateId=n.templateId;d.vars.isMobile=a.capabilities.mobile;!d.vars.A.objectIsEmpty(n)&&n.hasOwnProperty(e.IS_VIDEO_IMMERSIVE_PLAYER_KEY)&&(d.vars.isVideoImmersivePlayer=n.isVideoImmersivePlayer);a.off("vse:ns:player:"+d.vars.clientPrefix+":init");a.off("vse:ns:metadata:"+d.vars.clientPrefix+":init");a.off("vse:ns:socialShare:"+d.vars.clientPrefix+
":init");a.off("vse:ns:feedback:"+d.vars.clientPrefix+":init");a.off("vse:ns:relatedVideos:"+d.vars.clientPrefix+":init");a.off("vse:ns:ingressCarousel:"+d.vars.clientPrefix+":init");a.off("vse:"+d.vars.clientPrefix+":page:lightBoxOpened");a.off("vse:"+d.vars.clientPrefix+":page:lightBoxClosed");a.off("vse:"+d.vars.clientPrefix+":lazyload:relatedvideos:succeeded");q.when("mash").execute("VSEComponentAsset-Mash-Detection",function(a){d.vars.isMshop=!0;d.vars.mShopFactory=a});a.on("vse:ns:player:"+
d.vars.clientPrefix+":init",function(b){try{var c=v.fetchLatestPageState(a,b);if(c){var g=c.awaConfig;d.vars.isMobile=c.isMobile;d.vars.productAsin=c.productAsin;d.vars.playFullScreenVideo=c.enableFullScreenByDefault;d.vars.contentId=g.initialVideo;d.vars.containerId=g.containerId;d.vars.placement=g.sushiMetricsConfig.placementContext;d.vars.sushiMetricsConfig=g.sushiMetricsConfig;d.vars.useUpNextComponent=g.useUpNextComponent;d.vars.useUpNextComponent&&(d.vars.upNextString=c.upNextString?c.upNextString:
"UP NEXT",d.vars.cancelString=c.cancelString?c.cancelString:"CANCEL");b={gatedP:z,EventEmitter:F,promise:p};var h={videoUrl:c.videoUrl,contentId:d.vars.contentId,vendorCode:c.vendorCode,vendorTrackingId:c.vendorTrackingId,productAsin:c.productAsin,videoReferenceId:c.videoReferenceId,eventTimestamp:d.vars.A.now(),imageUrl:c.imageUrl,duration:0,refTag:e.EMPTY_STRING};d.setVideoDetails(d.vars.contentId,c);d.vars.showClosedCaptions=c.showClosedCaptions||!1;if(d.vars.showClosedCaptions){var k=c.initialClosedCaptions;
d.vars.A.objectIsEmpty(k)||d.setInitialClosedCaptions(h,k);d.vars.isVideoImmersivePlayer&&d.setupVIPClosedCaptions(c.closedCaptionsConfig,k)}g.initialVideo=h;d.vars.playerFactory=new O(b);d.vars.player=d.vars.playerFactory.create(g);!d.vars.isVideoImmersivePlayer&&d.vars.playFullScreenVideo&&(d.vars.player.aspectRatio(d.getAspectRatio(d.getDeviceOrientation())),d.vars.player.fluid(!1));if(d.vars.isVideoImmersivePlayer)d.vars.player.on("playerClick",d.onPlayerTapHandler);d.vars.A.trigger("vsePlayer-"+
d.vars.clientPrefix,{player:d.vars.player,containerId:d.vars.containerId});d.vars.A.trigger(d.vars.clientPrefix+":vse:player:registered")}else l.count(e.PLAYER_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+d.vars.clientPrefix,1),d.vars.A.trigger("vse-common-assets-player-"+b+"-initialization-failed")}catch(m){l.logFatal(e.ATTRIBUTION_NAME+":"+d.vars.clientPrefix,"Fatal during player initialization.",m)}});a.on("vse:ns:metadata:"+d.vars.clientPrefix+":init",function(b){try{var c=v.fetchLatestPageState(a,b);c?
(d.vars.videoVoteConfig=c.videoVoteConfig,d.vars.videoVoteConfig=a.$.extend({},d.vars.videoVoteConfig),b={gatedP:z,promise:p},d.vars.videoVoteConfig.hasOwnProperty("placementContext")&&(d.vars.videoVoteConfig.dependencies=b,d.vars.videoVoteContainerFactory=new P(a,d.vars.videoVoteConfig),d.vars.activeVideoVoteContainer=d.vars.videoVoteContainerFactory.createFromSelector("#vse-video-votes-lb-details-"+d.vars.videoVoteConfig.placementContext)),c.sushiMetricsConfig&&(d.vars.sushiMetricsConfig=c.sushiMetricsConfig,
d.vars.buildSushiPayload=I.makeApplicationSushiPayloadBuilder(d.vars.A,d.vars.sushiMetricsConfig),d.vars.emitSushiMetric=!0,d.vars.universalSushiEndpoint=d.vars.sushiMetricsConfig.endpoint,d.vars.A.trigger(d.vars.clientPrefix+":vse:sushiMetrics",{endpoint:d.vars.universalSushiEndpoint,sushiMetricsConfig:d.vars.sushiMetricsConfig,buildSushiPayload:d.vars.buildSushiPayload,postMetric:l})),d.vars.A.trigger(d.vars.clientPrefix+":vse:metadata:registered")):(l.count(e.METADATA_PAGE_STATE_NOT_FOUND_ERROR_KEY+
":"+d.vars.clientPrefix,1),d.vars.A.trigger("vse-common-assets-metadata-"+b+"-initialization-failed"))}catch(g){l.logFatal(e.ATTRIBUTION_NAME+":"+d.vars.clientPrefix,"Fatal during metadata initialization.",g)}});a.on("vse:ns:socialShare:"+d.vars.clientPrefix+":init",function(b){try{var c=v.fetchLatestPageState(a,b);c?(d.vars.socialSharePageState=b,d.vars.socialShareId=c.id,d.vars.A.off("a:declarative:"+d.vars.clientPrefix+"-social-share-mshop-action:click"),d.vars.A.off("a:declarative:"+d.vars.clientPrefix+
"-social-share-mshop-action:touch"),d.vars.A.declarative(d.vars.clientPrefix+"-social-share-mshop-action","click touch",function(a){d.vars.isMshop&&!d.vars.A.objectIsEmpty(d.vars.mShopFactory)&&(a=d.vars.relatedVideosCarousel.getActiveAsset(),a=d.getMshopShareParams(a),d.vars.mShopFactory.share(a))}),d.vars.A.off("a:declarative:"+d.vars.clientPrefix+"-swf-share-network:click"),d.vars.A.declarative(d.vars.clientPrefix+"-swf-share-network","click",function(a){a=a.data;var b=d.vars.A.state(d.vars.socialSharePageState);
W.share(b,a.network);l.count(e.socialShareClickMetricName,1);d.vars.isVideoImmersivePlayer&&d.emitClickMetric(e.METRIC_SHARE_SELECTION_CLICK)}),d.vars.A.trigger(d.vars.clientPrefix+":vse:socialShare:registered")):(l.count(e.SOCIAL_SHARE_STATE_NOT_FOUND_ERROR_KEY+":"+d.vars.clientPrefix,1),d.vars.A.trigger("vse-common-assets-social-share-"+b+"-initialization-failed"))}catch(g){l.logFatal(e.ATTRIBUTION_NAME+":"+d.vars.clientPrefix,"Fatal during socialShare initialization.",g)}});a.on("vse:ns:feedback:"+
d.vars.clientPrefix+":init",function(a){try{var b=v.fetchLatestPageState(d.vars.A,a);if(b){var c=b.id,f="#"+d.vars.containerId+"-container",h="#vse-"+d.vars.clientPrefix+"-feedback-container";d.vars.cursorOnVideoPlayerDiv=!1;d.deRegisterFeedback(c);d.vars.A.on("vse:"+c+":feedback:shown",function(){d.pauseVideoIfNeeded();d.vars.isFeedbackClosed=!1;d.vars.$(".vse-fb-copyright").click(function(a){d.vars.isMshop&&d.vars.isVideoImmersivePlayer&&(d.vars.feedback.hideFeedbackForm(),d.openExternalLinkFromLightBox(a))})});
d.vars.A.on("vse:"+c+":feedback:hidden",function(){d.vars.vipControlsShouldPause&&d.resumeVideoIfNeeded();d.vars.isFeedbackClosed=!0;d.vars.cursorOnVideoPlayerDiv||d.hideFeedbackLink(h,f);d.vars.$(".vse-fb-copyright").unbind("click");d.vars.isMshop&&d.vars.mShopFactory&&d.vars.A.delay(function(){d.vars.mShopFactory.dispatchEvent({type:"appOverlays.Hide"})},500)});var k=new ea({A:d.vars.A,buttonApi:g});d.vars.feedback=k.create(c,a);d.updateFeedback(d.vars.currentAssetSpec);d.vars.isFeedbackClosed=
!0;var m=d.vars.A.$(h);d.vars.A.$(f).append(m);d.vars.isVideoImmersivePlayer||(d.vars.A.declarative.create(d.vars.$(f),"feedback-overlays-player",{}),d.vars.A.declarative("feedback-overlays-player","mouseenter touchstart focus",function(){(d.vars.isFeedbackClosed||d.vars.isMobile)&&d.showFeedbackLink(h,f);d.vars.cursorOnVideoPlayerDiv=!0}),d.vars.A.declarative("feedback-overlays-player","mouseleave",function(){(d.vars.isFeedbackClosed||d.vars.isMobile)&&d.hideFeedbackLink(h,f);d.vars.cursorOnVideoPlayerDiv=
!1}));d.vars.A.trigger(d.vars.clientPrefix+":vse:feedback:registered")}else l.count(e.FEEDBACK_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+d.vars.clientPrefix,1),d.vars.A.trigger("vse-common-assets-feedback-"+a+"-initialization-failed")}catch(p){l.logFatal(e.ATTRIBUTION_NAME+":"+d.vars.clientPrefix,"Fatal during feedback initialization.",p)}});a.on("vse:ns:relatedVideos:"+d.vars.clientPrefix+":init",function(b){try{var g=v.fetchLatestPageState(a,b);if(g){var q=new H(c,a,{gatedP:z,promise:p});c.createAll();
c.initializeAll();d.vars.relatedVideosCarousel=q.create(g);d.vars.A.on("vse:contentCarousel:"+g.carouselName+":click",function(a){d.vars.A.objectIsEmpty(d.vars.player)||(d.vars.player.play(a),d.vars.currentIndex=d.vars.relatedVideosCarousel.findIndex(a),d.show(a),d.vars.isVideoImmersivePlayer&&(d.vars.isUpNextComponentActive&&d.removeUpNextComponent(),d.vars.videoActionTrayComponents.updateActiveVideoContentId(a),d.vars.currentAssetSpec=a,d.resetUserActivityTimer(),d.showVideoImmersivePlayerOverlay(),
d.vars.isVIPOverlayTimerSet||(d.vars.intervalUserActivityHandlerId=d.userActivityCountDown()),d.vars.videoActionTrayComponents.reset(),d.emitClickMetric(e.METRIC_WATCH_THUMBNAIL_CLICK)))});d.isImageBlockVIP()&&(d.vars.currentIndex=d.vars.relatedVideosCarousel.findIndex(d.vars.currentAssetSpec));var n=d.getCurrentlyPlayingVideoInCarouselMarkAsPlaying(d.vars.currentIndex);d.updateVideoMetadataIfNeeded(n);d.vars.relatedVideosCarousel.markPlaying(n);d.vars.initialVideo=n;d.vars.showVotes=d.vars.videoVoteContainerFactory&&
d.vars.videoVoteContainerFactory.videoVoteConfig&&n&&n.videoVoteContainer&&!d.vars.videoVoteFailure;d.vars.showVotes&&(d.updateActiveVideoVoteContainer(d.vars.relatedVideosCarousel.getActiveAsset()),d.vars.A.on(d.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-hide-votes",function(){d.vars.activeVideoVoteContainer.showOrHide(!1,!1,!1,!1);d.vars.videoVoteFailure=!0}),d.vars.A.off("a:declarative:"+(d.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-positive")+":click"),
d.vars.A.off("a:declarative:"+(d.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-negative")+":click"),d.vars.A.declarative(d.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-positive","click",function(){d.castVote(k.POSITIVE_VOTE)}),d.vars.A.declarative(d.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-negative","click",function(){d.castVote(k.NEGATIVE_VOTE)}),d.vars.A.on(d.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-cast",
function(a){var b=a===k.POSITIVE_VOTE?k.NEGATIVE_VOTE:k.POSITIVE_VOTE,c=d.vars.relatedVideosCarousel.getActiveAsset(),f=k.EMPTY_STRING;c&&c.videoVoteContainer&&(f=c.videoVoteContainer.getPreviousVote()===a?"cancel:"+a:c.videoVoteContainer.getPreviousVote()===k.POSITIVE_VOTE||c.videoVoteContainer.getPreviousVote()===k.NEGATIVE_VOTE?"switch-"+b+"-to-"+a:a,c.videoVoteContainer.updateWithNewVote(a));d.vars.emitSushiMetric&&(a=d.vars.buildSushiPayload({eventName:d.vars.clientPrefix+"ibiv.videovote.castvote:"+
f,stringPayload:e.EMPTY_STRING,intPayload:1,videoAsin:c.contentId}),l.emitSushiMetric(a,d.vars.sushiMetricsConfig.endpoint))}));d.createContinuousPlayPlaylist(n);d.attachPlayerEventListeners();d.updateFeedback(n);d.refreshSocialSharePageState(n);d.attachStickyHeaders();d.vars.isVideoImmersivePlayer&&(d.initializeVideoActionTray(g.segmentTabs,g.carouselCardWidth),d.updateSegmentTab(n),d.vars.videoActionTrayComponents.updateActiveVideoContentId(n.contentId),d.emitRelatedVideosRenderMetric(e.METRIC_WATCH_THUMBNAIL_RENDER));
d.vars.shouldShowProfiles=g.includeProfiles;d.vars.shouldShowProfiles&&(d.getCustomerProfileDomElements(),d.isCustomerReviewVideo(n)&&d.updateCustomerProfile(n),d.isInfluencerVideo(n)&&d.updateInfluencerProfile(n),d.dom.$activeVideoCustomerProfile.delegate(".vse-profile","click",function(a){a=d.vars.$(a.target).closest("."+e.VIPVideoInfoClassName).find(".vse-profile").attr("href");d.openExternalLinkFromLightBox(a)}),a.trigger("resize",{},{width:h.innerWidth,height:h.innerHeight}));d.vars.lightboxCarouselRegistered=
!0;d.vars.A.trigger(d.vars.clientPrefix+":vse:relatedVideos:registered")}else d.vars.showVotes=!1,l.count(e.RV_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+d.vars.clientPrefix,1),d.vars.A.trigger("vse-common-assets-carousel-"+b+"-initialization-failed")}catch(X){l.logFatal(e.ATTRIBUTION_NAME+":"+d.vars.clientPrefix,"Fatal during carousel initialization.",X)}});a.on("vse:ns:ingressCarousel:"+d.vars.clientPrefix+":init",function(g,h){try{d.vars.widgetStartTime=h;d.vars.A.on("scroll",d.vseCsmWidgetLoadedMetrics);
var k=a.now(),n=v.fetchLatestPageState(a,g);if(n){d.vars.popoverName=n.lightboxPopoverConfig.popoverId;var q=d.vars.popoverName+"-trigger",t=d.vars.popoverName+"-wrapper",u=new H(c,a,{gatedP:z,EventEmitter:F,promise:p});d.vars.ingressCarousel=u.create(n);d.vars.ingressPlaylist=d.vars.ingressCarousel.getplaylist();d.vars.modalFactory=d.getModalFactory();a.on("vse:contentCarousel:"+n.carouselName+":click",function(b){var c=d.vars.modalFactory&&d.vars.modalFactory.get(d.vars.$("#"+q));l.count(""+d.vars.clientPrefix+
e.METRIC_WIDGET_CLICK,1);c?(c.show(),a.off("a:popover:afterShow:"+d.vars.popoverName),a.on("a:popover:afterShow:"+d.vars.popoverName,function(c){a.$(c.popover.$popover).addClass(a.$("#"+t).data("cssClass"));a.trigger("vse:"+d.vars.clientPrefix+":page:lightBoxOpened",{assetSpec:b,lightBoxId:t})}),d.vars.emitSushiMetric&&d.emitWidgetClickMetric()):l.count(e.LB_POPOVER_NOT_FOUND_ERROR_KEY+":"+d.vars.clientPrefix,1)});a.on("a:popover:beforeHide:"+d.vars.popoverName,function(){a.objectIsEmpty(d.vars.ingressCarousel)||
d.vars.ingressCarousel.destroy();a.trigger("vse:"+d.vars.clientPrefix+":page:lightBoxClosed")});var w=a.now();l.count(b+".requestToReadyDuration",w-h);l.count(b+".requestToInitDuration",k-h);l.count(b+".initToReadyDuration",w-k);a.$("#vse-spinner").addClass("aok-hidden");d.vars.emitSushiMetric&&d.emitThumbnailRenderMetric(b+".thumbnailRender",1);d.vars.A.trigger(d.vars.clientPrefix+":vse:ingressCarousel:registered")}else d.vars.showVotes=!1,l.count(e.INGRESS_RV_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+
d.vars.clientPrefix,1),d.vars.A.trigger("vse-common-assets-carousel-"+g+"-initialization-failed")}catch(y){l.logFatal(e.ATTRIBUTION_NAME+":"+d.vars.clientPrefix,"Fatal during carousel initialization.",y)}});a.on("vse:"+d.vars.clientPrefix+":page:lightBoxOpened",function(c){d.vars.lightboxOpened=!0;d.vars.popoverId=c.lightBoxId;d.vars.A.objectIsEmpty(c.assetSpec)&&(d.vars.ingressHasInitialAssetSpec=!1);d.vars.lightboxCarouselRegistered?(d.vars.ingressHasInitialAssetSpec?(d.vars.currentIndex=d.vars.relatedVideosCarousel.findIndex(c.assetSpec),
d.vars.currentAssetSpec=d.getCurrentlyPlayingVideoInCarouselMarkAsPlaying(d.vars.currentIndex)):(d.vars.currentAssetSpec=d.vars.relatedVideosCarousel.getActiveAsset(),d.vars.currentIndex=d.vars.currentAssetSpec.index),d.createContinuousPlayPlaylist(d.vars.currentAssetSpec)):(d.vars.currentIndex=d.vars.ingressHasInitialAssetSpec?c.assetSpec.index:0,d.vars.currentAssetSpec=d.vars.ingressHasInitialAssetSpec?c.assetSpec:d.vars.initialVideo,d.vars.ingressHasInitialAssetSpec&&d.vars.A.objectIsEmpty(d.vars.currentAssetSpec.vendorName)&&
(d.vars.currentAssetSpec.vendorName=d.vars.initialVideo.vendorName));d.vars.lightboxOpenedFirstTime&&d.getDomElements(d.vars.popoverId,d.vars.templateId);d.vars.$("body").addClass("vse-lb-no-scroll");d.vars.$("#"+d.vars.popoverId).addClass("vse-lb-opened");d.show(d.vars.currentAssetSpec);d.startPlaying(d.vars.currentAssetSpec);d.vars.lightboxOpenedFirstTime?(a.trigger("resize",{},{width:h.innerWidth,height:h.innerHeight}),d.vars.showClosedCaptions&&!d.vars.isVideoImmersivePlayer&&d.setupDefaultClosedCaptionsMetrics()):
d.resizeLB();d.attachStickyHeaders();d.vars.isVideoImmersivePlayer&&(c=d.vars.isMshop?"vse-vip-lb-mshop":"vse-vip-lb-mweb",d.vars.$(e.VIPLightboxSelector).addClass(c),d.needToUpdateVideoInfoLater()?d.clearCurrentVideoInfo():(d.resetUserActivityTimer(),d.showVideoImmersivePlayerOverlay()),d.vars.intervalUserActivityHandlerId=d.userActivityCountDown(),d.initializeVIPControls(),d.vars.lightboxOpenedFirstTime||(d.updateSegmentTab(d.vars.currentAssetSpec),d.vars.lightboxCarouselRegistered&&d.vars.videoActionTrayComponents.updateActiveVideoContentId(d.vars.currentAssetSpec.contentId)),
a.delay(function(){d.vars.$("body").addClass("vse-vip-body")},250),d.emitMetric(e.METRIC_VIP_OPEN));d.vars.A.delay(function(){d.dom.$wrapper.find(".vse-lb-container").animate({opacity:1},200)},200);d.dom.$activeVideoOspLink.click(function(a){d.openExternalLinkFromLightBox(a)});d.dom.$activeVideoCRLink.click(function(a){d.openExternalLinkFromLightBox(a)});!d.vars.isMobile&&d.vars.placement&&-1!==d.vars.placement.toLowerCase().indexOf("search")&&d.vars.$("#"+d.vars.popoverId).closest(".vse-lightbox-wrapper").addClass("vse-responsive-lightbox");
d.vars.isMobile&&d.vars.placement&&-1!==d.vars.placement.toLowerCase().indexOf("search")&&d.vars.$("#"+d.vars.popoverId).closest(".vse-lightbox-wrapper").removeClass("vse-responsive-lightbox");d.isImageBlockVIP()&&d.vars.$("#"+d.vars.popoverId).closest(".video-immersive-view-gallery").addClass("vse-vip");d.vars.isMshop&&d.vars.isVideoImmersivePlayer&&d.requestMshopFullscreen();c=v.fetchLatestPageState(a,d.vars.templateId+"-lazyload-request-ps");d.vars.A.objectIsEmpty(c)?(d.vars.lightboxOpenedFirstTime=
!1,l.count(e.LAZY_LOAD_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+d.vars.clientPrefix,1)):d.vars.lightboxOpenedFirstTime&&(c=a.$.extend({video:{contentID:d.vars.currentAssetSpec.contentId,contentIDType:"ASIN",videoURL:d.vars.currentAssetSpec.videoUrl,imageURL:d.vars.currentAssetSpec.imageURL}},c),fa.getLazyLoadComponents(d.vars.A,d.vars.popoverId,c,function(a,c){d.vars.A.trigger("vse:"+b+":lazyload:"+c.configuration.type+":succeeded")},function(a,c){d.vars.A.trigger("vse:"+b+":lazyload:"+c.configuration.type+
":failed")}),d.vars.lightboxOpenedFirstTime=!1)});a.on("vse:"+d.vars.clientPrefix+":page:lightBoxClosed",function(){d.vars.lightboxOpened&&(d.vars.lightboxOpened=!1,d.vars.ingressHasInitialAssetSpec=!0,d.dom.$wrapper.find(".vse-lb-container").animate({opacity:0}),d.vars.$("body").removeClass("vse-lb-no-scroll"),d.resetStickyHeaders(),d.vars.player.pause(),d.vars.isVideoImmersivePlayer&&(d.vars.$("body").removeClass("vse-vip-body"),d.clearIntervalUserActivityHandler(),d.vars.lightboxCarouselRegistered&&
d.vars.videoActionTrayComponents.reset(),d.emitMetric(e.METRIC_VIP_CLOSE),d.resetVIPControls(),d.vars.isMshop&&d.vars.isVideoImmersivePlayer&&d.cancelMshopFullscreen()))});a.on("vse:"+d.vars.clientPrefix+":lazyload:relatedvideos:succeeded",function(){d.resizeLB()});a.on("vse:"+d.vars.clientPrefix+":lazyload:relatedvideos:failed",function(){d.vars.isVideoImmersivePlayer&&d.vars.A.hide(d.vars.A.$("#"+d.vars.templateId+" "+e.VIPWatchIconBlockSelector))});a.on("vse:ns:relatedVideos:"+d.vars.clientPrefix+
":hide",function(){d.vars.lightboxOpened&&d.vars.isVideoImmersivePlayer&&d.vars.A.hide(d.vars.A.$("#"+d.vars.templateId+" "+e.VIPWatchIconBlockSelector))});a.on("resize",function(){d.vars.lightboxOpened&&d.resizeLB()});a.on.orientationchange(function(a){!d.vars.isVideoImmersivePlayer&&d.vars.playFullScreenVideo&&(0===a.orientation?d.vars.player.aspectRatio(d.getAspectRatio(e.PORTRAIT)):d.vars.player.aspectRatio(d.getAspectRatio(e.LANDSCAPE)));d.vars.isMobile&&d.vars.lightboxOpened&&(d.vars.$("#"+
d.vars.popoverId).height(h.innerHeight),d.dom.$lbContainer.height(h.innerHeight))})},TestModules:ba,Utils:R,_noneFeature:b()}})})};q.when("A","3p-promise").execute("VSE-gatedP-register-VSEComponentAssets-client",function(c,b){z.register("VSEComponentAssets","VSE-VSEComponentAssets-client-registered",ga,b)})}catch(c){l.logError(e.ATTRIBUTION_NAME,"Error during VSE AUI module registration.",c)}})()});